[{"path":"https://kuan-liu-lab.github.io/bayesmsm/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 bayesmsm authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-censoring.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"`bayesmsm` for longitudinal data with informative right-censoring","text":"bayesmsm package enables easy implementation Bayesian marginal structural models (BMSMs) longitudinal data. methodology BMSMs can divided 2 estimation steps: Step 1. Bayesian treatment effect weight estimation Step 2. Bayesian non-parametric bootstrap maximize utility function respect causal effect Step 1, estimate treatment weights wijw_{ij} using posterior samples α\\alpha β\\beta via fitting series logistic regressions Bayesian framework. package incorporates Inverse Probability Treatment Weighting (IPTW) Inverse Probability Censoring Weighting (IPCW) handle longitudinal data without right-censoring. Step 2, Pn(vij)P_n(v_{ij}) estimated via non-parametric Bayesian bootstrap Dir(1,...,1)Dir(1,...,1) sampling weights. main functions package include: bayesweight: Calculates Bayesian weights subject-specific treatment effects. bayesweight_cen: Calculates Bayesian weights subject-specific treatment effects right-censored data. bayesmsm: Estimates marginal structural models using calculated Bayesian weights. plot_ATE: Plots estimated Average Treatment Effect (ATE). plot_APO: Plots estimated Average Potential Outcome (APO). plot_est_box: Plots distribution estimated treatment effects. summary_bayesmsm: Summarizes model results bayesmsm. Installation install bayesmsm package, can use devtools package install directly GitHub.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-censoring.html","id":"simulated-observational-data-with-right-censoring","dir":"Articles","previous_headings":"","what":"Simulated observational data with right-censoring","title":"`bayesmsm` for longitudinal data with informative right-censoring","text":"illustrate implementation bayesmsm package using simulated dataset. simulated dataset contains right-censoring binary end--study outcome. example provide comprehensive understanding apply package real-world data.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-censoring.html","id":"dataset-introduction","dir":"Articles","previous_headings":"","what":"Dataset Introduction","title":"`bayesmsm` for longitudinal data with informative right-censoring","text":"simulation study, use simulated longitudinal dataset mimic complex real-world clinical data right-censoring. dataset consists 500 patients observed 3 visits. binary outcome variable represents end--study status patients. dataset includes baseline covariates L11L11 L21L21, L11L11 binary L21L21 continuous. Time-dependent covariates L12L12 L22L22 observed second visit, L13L13 L23L23 third visit. treatment variables represented A1A1, A2A2, A3A3 three visits. Right-censoring indicators represented C1C1, C2C2, C3C3. example, observations C1=1C1 = 1, records visit 1 censored. Description Simulated Right-Censored Dataset","code":"# example simulated causal data with censoring; simdat_cen <- read.csv(system.file(\"extdata\", \"sim_causal.csv\", package = \"bayesmsm\"))  # look at the data; head(simdat_cen) #>   L11         L21 A1 L12        L22 A2 L13        L23 A3 C1 C2 C3  Y #> 1   0 -0.37560287 NA  NA         NA NA  NA         NA NA  1 NA NA NA #> 2   1 -0.56187636 NA  NA         NA NA  NA         NA NA  1 NA NA NA #> 3   0 -0.34391723  1   1 -0.8053290  1   1 -2.5508298  1  0  0  0  0 #> 4   1  0.09049665  1   1 -1.7754302  1   1 -2.2849997  0  0  0  0  0 #> 5   1  1.59850877  1   1  0.5604468  1   0  2.1787137  0  0  0  0  1 #> 6   0 -0.08856511  0   0  1.4798603  0   1  0.7025151  0  0  0  0  1"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-censoring.html","id":"bayesian-treatment-effect-weight-estimation-using-bayesweight_cen","dir":"Articles","previous_headings":"","what":"Bayesian treatment effect weight estimation using bayesweight_cen","title":"`bayesmsm` for longitudinal data with informative right-censoring","text":"Next, use bayesweight_cen function estimate weights censoring. specify treatment censoring models time point, including relevant covariates. trtmodel.list: list formulas corresponding time point time-specific treatment variable left hand side pre-treatment covariates balanced right hand side. Interactions functions covariates allowed. cenmodel.list: list formulas censoring model censoring indicators left hand side covariates prior censoring indicators right hand side. data: dataset containing variables specified trtmodel.list. n.chains: Number MCMC chains run. non-parallel execution, set 1. parallel execution, requires least 2 chains. n.iter: Total number iterations chain (including burn-). n.burnin: Number iterations discard beginning simulation (burn-). n.thin: Thinning rate MCMC sampler. seed: Seed ensure reproducibility. parallel: Logical flag indicating whether run MCMC chains parallel. Default TRUE. Similarly, function automatically run MCMC JAGS based specified treatment censoring model inputs, generating JAGS model string part function output. function returns list containing updated weights subject-specific treatment censoring effects well JAGS model. can print view JAGS model stored model_string function output:","code":"weights_cen <- bayesweight_cen(trtmodel.list = list(A1 ~ L11 + L21,                                                 A2 ~ L11 + L21 + L12 + L22 + A1,                                                 A3 ~ L11 + L21 + L12 + L22 + A1 + L13 + L23 + A2),                            cenmodel.list = list(C1 ~ L11 + L21,                                                 C2 ~ L11 + L21 + A1,                                                 C3 ~ L11 + L21 + A1 + L12 + L22 + A2),                            data = simdat_cen,                            n.chains = 1,                            n.iter = 200,                            n.burnin = 100,                            n.thin = 1,                            seed = 890123,                            parallel = FALSE) #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 4836 #>    Unobserved stochastic nodes: 44 #>    Total graph size: 16501 #>  #> Initializing model summary(weights_cen$weights) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's  #>  0.3966  1.0348  1.7860  2.7652  3.5724 21.8808     136 cat(weights_cen$model_string) #> model{ #>  #> for (i in 1:N1) { #>  #> # conditional model; #> A1[i] ~ dbern(p1[i]) #> logit(p1[i]) <- b10 + b11*L11[i] + b12*L21[i] #> C1[i] ~ dbern(cp1[i]) #> logit(cp1[i]) <- s10 + s11*L11[i] + s12*L21[i] #>  #> # marginal model; #> A1s[i] ~ dbern(p1s[i]) #> logit(p1s[i]) <- bs10 #> C1s[i] ~ dbern(cp1s[i]) #> logit(cp1s[i]) <- ts10 #> } #>  #> for (i in 1:N2) { #>  #> # conditional model; #> A2[i] ~ dbern(p2[i]) #> logit(p2[i]) <- b20 + b21*L11[i] + b22*L21[i] + b23*L12[i] + b24*L22[i] + b25*A1[i] #> C2[i] ~ dbern(cp2[i]) #> logit(cp2[i]) <- s20 + s21*L11[i] + s22*L21[i] + s23*A1[i] #>  #> # marginal model; #> A2s[i] ~ dbern(p2s[i]) #> logit(p2s[i]) <- bs20 + bs21*A1s[i] #> C2s[i] ~ dbern(cp2s[i]) #> logit(cp2s[i]) <- ts20 + ts21*A1s[i] #> } #>  #> for (i in 1:N3) { #>  #> # conditional model; #> A3[i] ~ dbern(p3[i]) #> logit(p3[i]) <- b30 + b31*L11[i] + b32*L21[i] + b33*L12[i] + b34*L22[i] + b35*A1[i] + b36*L13[i] + b37*L23[i] + b38*A2[i] #> C3[i] ~ dbern(cp3[i]) #> logit(cp3[i]) <- s30 + s31*L11[i] + s32*L21[i] + s33*A1[i] + s34*L12[i] + s35*L22[i] + s36*A2[i] #>  #> # marginal model; #> A3s[i] ~ dbern(p3s[i]) #> logit(p3s[i]) <- bs30 + bs31*A1s[i] + bs32*A2s[i] #> C3s[i] ~ dbern(cp3s[i]) #> logit(cp3s[i]) <- ts30 + ts31*A1s[i] + ts32*A2s[i] #> } #>  #> # Priors #> b10 ~ dunif(-10, 10) #> b11 ~ dunif(-10, 10) #> b12 ~ dunif(-10, 10) #> s10 ~ dunif(-10, 10) #> s11 ~ dunif(-10, 10) #> s12 ~ dunif(-10, 10) #> bs10 ~ dunif(-10, 10) #> ts10 ~ dunif(-10, 10) #> b20 ~ dunif(-10, 10) #> b21 ~ dunif(-10, 10) #> b22 ~ dunif(-10, 10) #> b23 ~ dunif(-10, 10) #> b24 ~ dunif(-10, 10) #> b25 ~ dunif(-10, 10) #> s20 ~ dunif(-10, 10) #> s21 ~ dunif(-10, 10) #> s22 ~ dunif(-10, 10) #> s23 ~ dunif(-10, 10) #> bs20 ~ dunif(-10, 10) #> bs21 ~ dunif(-10, 10) #> ts20 ~ dunif(-10, 10) #> ts21 ~ dunif(-10, 10) #> b30 ~ dunif(-10, 10) #> b31 ~ dunif(-10, 10) #> b32 ~ dunif(-10, 10) #> b33 ~ dunif(-10, 10) #> b34 ~ dunif(-10, 10) #> b35 ~ dunif(-10, 10) #> b36 ~ dunif(-10, 10) #> b37 ~ dunif(-10, 10) #> b38 ~ dunif(-10, 10) #> s30 ~ dunif(-10, 10) #> s31 ~ dunif(-10, 10) #> s32 ~ dunif(-10, 10) #> s33 ~ dunif(-10, 10) #> s34 ~ dunif(-10, 10) #> s35 ~ dunif(-10, 10) #> s36 ~ dunif(-10, 10) #> bs30 ~ dunif(-10, 10) #> bs31 ~ dunif(-10, 10) #> bs32 ~ dunif(-10, 10) #> ts30 ~ dunif(-10, 10) #> ts31 ~ dunif(-10, 10) #> ts32 ~ dunif(-10, 10) #> }"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-censoring.html","id":"bayesian-non-parametric-bootstrap-to-maximize-the-utility-function-with-respect-to-the-causal-effect-using-bayesmsm","dir":"Articles","previous_headings":"","what":"Bayesian non-parametric bootstrap to maximize the utility function with respect to the causal effect using bayesmsm","title":"`bayesmsm` for longitudinal data with informative right-censoring","text":"Using weights estimated bayesweight_cen, now fit Bayesian Marginal Structural Model estimate marginal treatment effects using bayesmsm function . specify outcome model relevant parameters. bayesmsm function returns model object containing following: mean, standard deviation, 95% credible interval Risk Difference (RD), Risk Ratio (RR), Odds Ratio (). also includes data frame containing bootstrap samples reference effect, comparator effect, RD, RR, , well reference comparator levels chosen user. summary_bayesmsm function automatically generates summary table model output function bayesmsm.","code":"# Remove all NAs (censored observations) from the original dataset and weights simdat_cen <- na.omit(simdat_cen) weights_cen$weights <- na.omit(weights_cen$weights)  model <- bayesmsm(ymodel = Y ~ A1+A2+A3,                   nvisit = 3,                   reference = c(rep(0, 3)),                   comparator = c(rep(1, 3)),                   family = \"binomial\",                   data = simdat_cen,                   wmean = weights_cen$weights,                   nboot = 50,                   optim_method = \"BFGS\",                   parallel = TRUE,                   seed = 890123,                   ncore = 2) str(model) #> List of 12 #>  $ RD_mean    : num 0.23 #>  $ RR_mean    : num 1.56 #>  $ OR_mean    : num 2.97 #>  $ RD_sd      : num 0.114 #>  $ RR_sd      : num 0.354 #>  $ OR_sd      : num 1.42 #>  $ RD_quantile: Named num [1:2] 0.0139 0.42 #>   ..- attr(*, \"names\")= chr [1:2] \"2.5%\" \"97.5%\" #>  $ RR_quantile: Named num [1:2] 1.02 2.35 #>   ..- attr(*, \"names\")= chr [1:2] \"2.5%\" \"97.5%\" #>  $ OR_quantile: Named num [1:2] 1.06 6.13 #>   ..- attr(*, \"names\")= chr [1:2] \"2.5%\" \"97.5%\" #>  $ bootdata   :'data.frame': 50 obs. of  5 variables: #>   ..$ effect_reference : num [1:50] 0.4624 -0.2683 -0.0994 -0.4618 -0.4679 ... #>   ..$ effect_comparator: num [1:50] 0.629 0.938 0.901 1.018 1.142 ... #>   ..$ RD               : num [1:50] 0.0388 0.2854 0.2359 0.348 0.373 ... #>   ..$ RR               : num [1:50] 1.06 1.66 1.5 1.9 1.97 ... #>   ..$ OR               : num [1:50] 1.18 3.34 2.72 4.39 5 ... #>  $ reference  : num [1:3] 0 0 0 #>  $ comparator : num [1:3] 1 1 1 summary_bayesmsm(model) #>                  mean        sd        2.5%     97.5% #> Reference  -0.1760620 0.3274180 -0.75963321 0.4380595 #> Comparator  0.7985806 0.2456904  0.36512879 1.1501634 #> RD          0.2301848 0.1136792  0.01389312 0.4199952 #> RR          1.5600476 0.3538751  1.02301493 2.3475914 #> OR          2.9669176 1.4221489  1.06257769 6.1301699"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-censoring.html","id":"visualization-functions-plot_ate-plot_apo-plot_est_box","dir":"Articles","previous_headings":"","what":"Visualization functions: plot_ATE, plot_APO, plot_est_box","title":"`bayesmsm` for longitudinal data with informative right-censoring","text":"Similarly, can use built-functions well summary_bayesmsm visualize summarize results. plot_ATE function generates plot estimated ATE 95% credible interval.  plot_APO function plots estimated APO reference comparator level effects.   plot_est_box function generates error bar plot estimated treatment effects (APO ATE) bootstrap samples.","code":"plot_ATE(model) plot_APO(model, effect_type = \"effect_comparator\") plot_APO(model, effect_type = \"effect_reference\") plot_est_box(model)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-censoring.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"`bayesmsm` for longitudinal data with informative right-censoring","text":"Saarela, O., Stephens, D. ., Moodie, E. E. M., & Klein, M. B. (2015). Bayesian estimation marginal structural models. Biometrics, 71(2), 279–288. https://doi.org/10.1111/biom.12269 Robins, J. M., Hernán, M. ., & Brumback, B. (2000). Marginal structural models causal inference epidemiology. Epidemiology, 11(5), 550–560. https://doi.org/10.1097/00001648-200009000-00011 Liu, K., Saarela, O., Feldman, B. M., & Pullenayegum, E. (2020). Estimation causal effects repeatedly measured outcomes Bayesian framework. Statistical Methods Medical Research, 29(9), 2507–2519. https://doi.org/10.1177/0962280219900362","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-nocensoring.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"`bayesmsm` for longitudinal data without right-censoring","text":"bayesmsm package enables easy implementation Bayesian marginal structural models (BMSMs) longitudinal data. methodology BMSMs can divided 2 estimation steps: Step 1. Bayesian treatment effect weight estimation Step 2. Bayesian non-parametric bootstrap maximize utility function respect causal effect Step 1, estimate treatment weights wijw_{ij} using posterior samples α\\alpha β\\beta via fitting series logistic regressions Bayesian framework. package incorporates Inverse Probability Treatment Weighting (IPTW) Inverse Probability Censoring Weighting (IPCW) handle longitudinal data without right-censoring. Step 2, Pn(vij)P_n(v_{ij}) estimated via non-parametric Bayesian bootstrap Dir(1,...,1)Dir(1,...,1) sampling weights. main functions package include: bayesweight: Calculates Bayesian weights subject-specific treatment effects. bayesweight_cen: Calculates Bayesian weights subject-specific treatment effects right-censored data. bayesmsm: Estimates marginal structural models using calculated Bayesian weights. plot_ATE: Plots estimated Average Treatment Effect (ATE). plot_APO: Plots estimated Average Potential Outcome (APO). plot_est_box: Plots distribution estimated treatment effects. summary_bayesmsm: Summarizes model results bayesmsm. Installation install bayesmsm package, can use devtools package install directly GitHub","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-nocensoring.html","id":"simulated-observational-data-with-a-time-dependent-treatment","dir":"Articles","previous_headings":"","what":"Simulated observational data with a time-dependent treatment","title":"`bayesmsm` for longitudinal data without right-censoring","text":"1000 patients 3 visits (2 patients assigned treatment) y, end--study continuous outcome z, binary treatment w1 w2 two baseline covariates (one continuous one binary, mimicking age sex) L1 L2 two time-dependent covariates (also one continuous one binary) missing data Frequency Counts Treatment Combinations Suppose causal parameter interest average treatment effect always treated never treated, ATE=E(Y∣Z1=1,Z2=1)−E(Y∣Z1=0,Z2=0) ATE = E(Y \\mid Z_1 = 1, Z_2 = 1) - E(Y \\mid Z_1 = 0, Z_2 = 0)","code":"# example simulated causal data; testdata <- read.csv(system.file(\"extdata\", \"continuous_outcome_data.csv\", package = \"bayesmsm\"))  # look at the data; head(testdata) #>   w1        w2 L1_1       L2_1 a_1 L1_2       L2_2 a_2          y #> 1  0  9.592429    0 -0.4156794   0    1 -0.1232054   0  0.9773712 #> 2  1  8.025206    1  0.3271899   0    0  1.0475552   0  0.5193338 #> 3  0 16.107140    0 -0.3805178   0    0  0.4515578   1 -0.8161817 #> 4  1 15.004245    0  1.3792701   0    1  0.2351548   0  3.6066315 #> 5  1  5.963334    0  0.2437692   0    0 -1.7327070   0 -0.1648256 #> 6  0 11.619410    0 -0.4990742   0    1  1.8224460   0  3.5454856 # frequency counts by treatment combinations; table(testdata$a_1, testdata$a_2) #>     #>       0   1 #>   0 520 201 #>   1 111 168"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-nocensoring.html","id":"bayesian-treatment-effect-weight-estimation-using-bayesweight","dir":"Articles","previous_headings":"","what":"Bayesian treatment effect weight estimation using bayesweight","title":"`bayesmsm` for longitudinal data without right-censoring","text":"Non-parallel computing requires n.chains = 1. Parallel MCMC requires least 2 chains computing running 1 core per chain, recommend using 2 chains less number available cores computer. Running function automatically saves JAGS model file working directory, user can check review model specifications. trtmodel.list: list formulas corresponding time point time-specific treatment variable left hand side pre-treatment covariates balanced right hand side. Interactions functions covariates allowed. data: dataset containing variables specified trtmodel.list. n.chains: Number MCMC chains run. non-parallel execution, set 1. parallel execution, requires least 2 chains. n.iter: Total number iterations chain (including burn-). n.burnin: Number iterations discard beginning simulation (burn-). n.thin: Thinning rate MCMC sampler. seed: Seed ensure reproducibility. parallel: Logical flag indicating whether run MCMC chains parallel. Default TRUE. weights: calculated weights subject-specific treatment effects, computed taking average weights across MCMC iterations. model_string: character JAGS model based input argument trtmodel.list. can print view JAGS model stored model_string function output:","code":"weights <- bayesweight(trtmodel.list = list(a_1 ~ w1 + w2 + L1_1 + L2_1,                                              a_2 ~ w1 + w2 + L1_1 + L2_1 + L1_2 + L2_2 + a_1),                         data = testdata,                         n.chains = 1,                         n.iter = 200,                         n.burnin = 100,                         n.thin = 1,                         seed = 890123,                         parallel = FALSE) #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 4000 #>    Unobserved stochastic nodes: 16 #>    Total graph size: 21040 #>  #> Initializing model str(weights) #> List of 2 #>  $ weights     : num [1:1000] 1.234 1.191 1.045 0.824 0.798 ... #>  $ model_string: chr \"model{\\n#N = nobs\\nfor(i in 1:N){\\n\\n# visit 1;\\n# marginal treatment assignment model, visit 1;\\na_1s[i] ~ dbe\"| __truncated__ cat(weights$model_string) #> model{ #> #N = nobs #> for(i in 1:N){ #>  #> # visit 1; #> # marginal treatment assignment model, visit 1; #> a_1s[i] ~ dbern(pa_1s[i]) #> pa_1s[i] <- ilogit(bs10) #>  #> # conditional treatment assignment model, visit 1; #> a_1[i] ~ dbern(pa_1[i]) #> pa_1[i] <- ilogit(b10 + b11*w1[i] + b12*w2[i] + b13*L1_1[i] + b14*L2_1[i]) #>  #> # visit 2; #> # marginal treatment assignment model, visit 2; #> a_2s[i] ~ dbern(pa_2s[i]) #> pa_2s[i] <- ilogit(bs20 + bs21*a_1s[i]) #>  #> # conditional treatment assignment model, visit 2; #> a_2[i] ~ dbern(pa_2[i]) #> pa_2[i] <- ilogit(b20 + b21*w1[i] + b22*w2[i] + b23*L1_1[i] + b24*L2_1[i] + b25*L1_2[i] + b26*L2_2[i] + b27*a_1[i]) #>  #> # export quantity in full posterior specification; #> w[i] <- (pa_1s[i]*pa_2s[i])/(pa_1[i]*pa_2[i]) #> } #>  #> #prior; #> bs10~dnorm(0,.01) #> b10~dnorm(0,.01) #> b11~dnorm(0,.01) #> b12~dnorm(0,.01) #> b13~dnorm(0,.01) #> b14~dnorm(0,.01) #> bs20~dnorm(0,.01) #> bs21~dnorm(0,.01) #> b20~dnorm(0,.01) #> b21~dnorm(0,.01) #> b22~dnorm(0,.01) #> b23~dnorm(0,.01) #> b24~dnorm(0,.01) #> b25~dnorm(0,.01) #> b26~dnorm(0,.01) #> b27~dnorm(0,.01) #> }"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-nocensoring.html","id":"bayesian-non-parametric-bootstrap-to-maximize-the-utility-function-with-respect-to-the-causal-effect-using-bayesmsm","dir":"Articles","previous_headings":"","what":"Bayesian non-parametric bootstrap to maximize the utility function with respect to the causal effect using bayesmsm","title":"`bayesmsm` for longitudinal data without right-censoring","text":"function bayesmsm estimates causal effect time-varying treatments. uses subject-specific treatment assignment weights weights calculated using bayesweight, performs Bayesian non-parametric bootstrap estimate causal parameters. ymodel: formula representing outcome model, can include interactions functions covariates. nvisit: Specifies number visits time points considered model. reference: baseline reference intervention across visits, typically represented vector zeros indicating treatment (default vector zeros). comparator: comparison intervention across visits, typically represented vector ones indicating full treatment (default vector ones). family: Specifies outcome distribution family; use “gaussian” continuous outcomes “binomial” binary outcomes (default “gaussian”). data: dataset containing variables required model. wmean: vector treatment assignment weights. Default vector ones, implying equal weighting. nboot: number bootstrap iterations perform estimating uncertainty around causal estimates. optim_method: optimization method used find best parameters model (default ‘BFGS’). seed: seed value ensure reproducibility results. parallel: logical flag indicating whether perform computations parallel (default TRUE). ncore: number cores use parallel computation (default 4). mean, sd, quantile: mean, standard deviation 95% credible interval estimated causal effect (ATE). results, mean ATE approximately -3.161, indicates expected outcome always treated patients , average, 3.161 units less never treated patients. bootdata: data frame containing bootstrap samples reference effect, comparator effect, average treatment effect (ATE). reference, comparator: reference level comparator level user chooses compare. reference level never treated (0,0), comparator level always treated (1,1). summary_bayesmsm function automatically generates summary table model output function bayesmsm.","code":"model <- bayesmsm(ymodel = y ~ a_1+a_2,                            nvisit = 2,                            reference = c(rep(0,2)),                            comparator = c(rep(1,2)),                            family = \"gaussian\",                            data = testdata,                            wmean = weights$weights,                            nboot = 50,                            optim_method = \"BFGS\",                            parallel = FALSE,                            seed = 890123,                            ncore = 2) str(model) #> List of 6 #>  $ RD_mean    : num -3.25 #>  $ RD_sd      : num 0 #>  $ RD_quantile: Named num [1:2] -3.25 -3.25 #>   ..- attr(*, \"names\")= chr [1:2] \"2.5%\" \"97.5%\" #>  $ bootdata   :'data.frame': 50 obs. of  3 variables: #>   ..$ effect_reference : num [1:50] 2.36 2.36 2.36 2.36 2.36 ... #>   ..$ effect_comparator: num [1:50] -0.891 -0.891 -0.891 -0.891 -0.891 ... #>   ..$ RD               : num [1:50] -3.25 -3.25 -3.25 -3.25 -3.25 ... #>  $ reference  : num [1:2] 0 0 #>  $ comparator : num [1:2] 1 1 summary_bayesmsm(model) #>                  mean sd       2.5%      97.5% #> Reference   2.3587741  0  2.3587741  2.3587741 #> Comparator -0.8912219  0 -0.8912219 -0.8912219 #> RD         -3.2499959  0 -3.2499959 -3.2499959"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-nocensoring.html","id":"visualization-functions-plot_ate-plot_apo-plot_est_box","dir":"Articles","previous_headings":"","what":"Visualization functions: plot_ATE, plot_APO, plot_est_box","title":"`bayesmsm` for longitudinal data without right-censoring","text":"bayesmsm package also provides several functions visualizing results: plot_ATE, plot_APO, plot_est_box. functions help user better interpret estimated causal effects. plot_ATE function generates plot estimated ATE 95% credible interval.  Similarly, plot_APO function plots estimated APO reference comparator level effects.   plot_est_box function generates error bar plot estimated treatment effects (APO ATE) bootstrap samples.","code":"plot_ATE(model) plot_APO(model, \"effect_reference\") plot_APO(model, \"effect_comparator\") plot_est_box(model)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/articles/bayesmsm-nocensoring.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"`bayesmsm` for longitudinal data without right-censoring","text":"Saarela, O., Stephens, D. ., Moodie, E. E. M., & Klein, M. B. (2015). Bayesian estimation marginal structural models. Biometrics, 71(2), 279–288. https://doi.org/10.1111/biom.12269 Robins, J. M., Hernán, M. ., & Brumback, B. (2000). Marginal structural models causal inference epidemiology. Epidemiology, 11(5), 550–560. https://doi.org/10.1097/00001648-200009000-00011 Liu, K., Saarela, O., Feldman, B. M., & Pullenayegum, E. (2020). Estimation causal effects repeatedly measured outcomes Bayesian framework. Statistical Methods Medical Research, 29(9), 2507–2519. https://doi.org/10.1177/0962280219900362","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kuan Liu. Author, maintainer, copyright holder. Xiao Yan. Author. Martin Urner. Author.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Liu K, Yan X, Urner M (2025). bayesmsm: Fitting Bayesian Marginal Structural Models Longitudinal Observational Data. R package version 1.0.0, https://github.com/Kuan-Liu-Lab/bayesmsm.","code":"@Manual{,   title = {bayesmsm: Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data},   author = {Kuan Liu and Xiao Yan and Martin Urner},   year = {2025},   note = {R package version 1.0.0},   url = {https://github.com/Kuan-Liu-Lab/bayesmsm}, }"},{"path":[]},{"path":"https://kuan-liu-lab.github.io/bayesmsm/index.html","id":"overview","dir":"","previous_headings":"","what":"Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data","title":"Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data","text":"bayesmsm R package implements Bayesian marginal structural models estimate average treatment effect drawing causal inference time-varying treatment assignment confounding extension handle informative right-censoring. Bayesian marginal structural models semi-parametric approach features two-step estimation process. first step involves Bayesian parametric estimation time-varying treatment assignment models second step involves non-parametric Bayesian bootstrap estimate average treatment effect two distinct treatment sequences interest. Reference paper Bayesian marginal structural models: Saarela, O., Stephens, D. ., Moodie, E. E., & Klein, M. B. (2015). Bayesian estimation marginal structural models. Biometrics, 71(2), 279-288. Liu, K., Saarela, O., Feldman, B. M., & Pullenayegum, E. (2020). Estimation causal effects repeatedly measured outcomes Bayesian framework. Statistical methods medical research, 29(9), 2507-2519.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data","text":"Install using devtools package:","code":"## install.packages(devtools) ## make sure to have devtools installed  devtools::install_github(\"Kuan-Liu-Lab/bayesmsm\") library(bayesmsm)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/index.html","id":"dependency","dir":"","previous_headings":"","what":"Dependency","title":"Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data","text":"package depends following R packages: MCMCpack doParallel foreach parallel R2jags coda","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data","text":"examples demonstrating use bayesmsm package:","code":"# Load example data without right-censoring testdata <- read.csv(system.file(\"extdata\", \"continuous_outcome_data.csv\", package = \"bayesmsm\"))  # Calculate Bayesian weights weights <- bayesweight(   trtmodel.list = list(     a_1 ~ w1 + w2 + L1_1 + L2_1,     a_2 ~ w1 + w2 + L1_1 + L2_1 + L1_2 + L2_2 + a_1   ),   data = testdata,   n.iter = 250,   n.burnin = 150,   n.thin = 5,   n.chains = 2,   seed = 890123,   parallel = TRUE )  # Perform Bayesian non-parametric bootstrap model <- bayesmsm(   ymodel = y ~ a_1 + a_2,   nvisit = 2,   reference = c(rep(0, 2)),   comparator = c(rep(1, 2)),   family = \"gaussian\",   data = testdata,   wmean = weights$weights,   nboot = 1000,   optim_method = \"BFGS\",   seed = 890123,   parallel = TRUE,   ncore = 2 )  # View model summary summary.bayesmsm(model)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data","text":"package licensed MIT License. See LICENSE file details.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data","text":"Please cite software using:","code":"@Manual{,   title = {bayesmsm: An R package for longitudinal causal analysis using Bayesian Marginal Structural Models},   author = {Xiao Yan and Martin Urner and Kuan Liu},   year = {2024},   note = {https://github.com/Kuan-Liu-Lab/bayesmsm},   url = {https://kuan-liu-lab.github.io/bayesmsm/}, }"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"Fitting Bayesian Marginal Structural Models for Longitudinal Observational Data","text":"e-mail: kuan.liu@utoronto.ca, Clarence.YXA@gmail.com Please report bugs opening issue.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesmsm.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian Marginal Structural Model Bootstrap Estimation — bayesmsm","title":"Bayesian Marginal Structural Model Bootstrap Estimation — bayesmsm","text":"`bayesmsm()` function performs Bayesian non-parametric bootstrap estimate causal effects Bayesian marginal structural models. supports continuous (Gaussian) binary (binomial) outcome variables","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesmsm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian Marginal Structural Model Bootstrap Estimation — bayesmsm","text":"","code":"bayesmsm(   ymodel,   nvisit,   reference = c(rep(0, nvisit)),   comparator = c(rep(1, nvisit)),   treatment_effect_type = \"sq\",   family = \"gaussian\",   data,   wmean = rep(1, nrow(data)),   nboot = 1000,   optim_method = \"BFGS\",   seed = NULL,   parallel = TRUE,   ncore = 4 )"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesmsm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian Marginal Structural Model Bootstrap Estimation — bayesmsm","text":"ymodel Model statement outcome variable. nvisit Number visits time points simulate. reference Vector denoting intervention used reference across visits calculating risk ratio risk difference. default vector 0's length nvisit (.e. never treated). comparator Vector denoting intervention used comparator across visits calculating risk ratio risk difference. default vector 1's length nvisit (.e. always treated). treatment_effect_type Character string specifying type treatment effect estimate. Options \"sq\" sequential treatment effects, estimates effects specific treatment sequences across visits, \"cum\" cumulative treatment effects, assumes single cumulative treatment variable representing total exposure. default \"sq\". family Character string specifying outcome distribution family. possible distributions : \"gaussian\" (default) continuous outcomes, \"binomial\" binary outcomes. data Data table containing variable names `ymodel`. wmean Vector treatment assignment weights. default rep(1, nrow(data)). nboot Integer specifying number bootstrap iterations. default 1000. optim_method Character string specifying optimization method used. default 'BFGS'. seed Starting seed simulations bootstrapping. default NULL. parallel Logical scalar indicating whether parallelize bootstrapping multiple cores. default TRUE. ncore Integer specifying number CPU cores use parallel simulation. argument required parallel set TRUE, default 4.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesmsm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian Marginal Structural Model Bootstrap Estimation — bayesmsm","text":"returns object class `bayesmsm` contains information data, model, etc. object class `bayesmsm` list containing least following components: * `mean`, mean bootstrap estimates * `sd`, standard deviation bootstrap estimates * `quantile`, 95 * `bootdata`, data frame bootstrapped estimates * `reference`, reference intervention level * `comparator`, comparison intervention level","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesmsm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian Marginal Structural Model Bootstrap Estimation — bayesmsm","text":"","code":"# Continuous outcome testdata <- read.csv(system.file(\"extdata\",                                  \"continuous_outcome_data.csv\",                                  package = \"bayesmsm\")) model <- bayesmsm(ymodel = y ~ a_1+a_2,                            nvisit = 2,                            reference = c(rep(0,2)),                            comparator = c(rep(1,2)),                            treatment_effect_type = \"sq\",                            family = \"gaussian\",                            data = testdata,                            wmean = rep(1, 1000),                            nboot = 10,                            optim_method = \"BFGS\",                            seed = 890123,                            parallel = FALSE)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian Treatment Effect Weight Estimation Using JAGS — bayesweight","title":"Bayesian Treatment Effect Weight Estimation Using JAGS — bayesweight","text":"`bayesweight()` function estimates Bayesian importance sampling weights time-varying treatment effects using specified models treatment time point via JAGS","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian Treatment Effect Weight Estimation Using JAGS — bayesweight","text":"","code":"bayesweight(   trtmodel.list,   data,   n.chains = 2,   n.iter = 25000,   n.burnin = 15000,   n.thin = 5,   seed = NULL,   parallel = TRUE )"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian Treatment Effect Weight Estimation Using JAGS — bayesweight","text":"trtmodel.list list formulas corresponding time point time-specific treatment variable left hand side pre-treatment covariates balanced right hand side. formulas must temporal order, must contain covariates balanced time point. Interactions functions covariates allowed. data data set form data frame containing variables `trtmodel.list`. must wide data set exactly one row per unit. n.chains Integer specifying number MCMC chains run. Set 1 non-parallel computation. parallel computation, required use least 2 chains. default 2. n.iter Integer specifying total number iterations chain (including burn-). default 25000. n.burnin Integer specifying number burn-iterations chain. default 15000. n.thin Integer specifying thinning rate MCMC sampler. default 5. seed Starting seed JAGS model. default NULL. parallel Logical scalar indicating whether run MCMC chains parallel. default TRUE.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian Treatment Effect Weight Estimation Using JAGS — bayesweight","text":"list calculated weights JAGS model: * `weights` vector posterior mean weights, computed taking average weights across MCMC iterations. * `model_string` character JAGS model based input `trtmodel.list`.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian Treatment Effect Weight Estimation Using JAGS — bayesweight","text":"","code":"# Continuous outcome testdata <- read.csv(system.file(\"extdata\",                                  \"continuous_outcome_data.csv\",                                  package = \"bayesmsm\")) weights <- bayesweight(trtmodel.list = list(a_1 ~ w1 + w2 + L1_1 + L2_1,                                             a_2 ~ w1 + w2 + L1_1 + L2_1 +                                                   L1_2 + L2_2 + a_1),                        data = testdata,                        n.chains = 1,                        n.iter = 20,                        n.burnin = 10,                        n.thin = 1,                        seed = 890123,                        parallel = FALSE) #> module glm loaded #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 4000 #>    Unobserved stochastic nodes: 16 #>    Total graph size: 21040 #>  #> Initializing model #>  #> Warning: Some parameters have not converged with Geweke index > 1.96. More iterations may be needed. weights$weights #>    [1] 1.2802239 1.2512517 1.0082633 0.8270653 0.8399185 1.3702919 1.6806930 #>    [8] 1.0088406 0.9228162 1.5525122 1.4639140 1.1133452 0.8916842 0.8935440 #>   [15] 1.0075997 0.8287458 1.6119119 1.1256125 1.9957740 0.9084475 0.8841174 #>   [22] 1.2064755 0.6934969 0.8034062 1.2457284 1.4318967 1.1532453 1.4277432 #>   [29] 0.7214424 1.6617311 1.3904921 0.9228318 0.9723330 0.7377996 1.5117722 #>   [36] 1.0738760 0.8486890 0.8089971 0.8473805 1.5515835 1.0002237 0.9233090 #>   [43] 1.1705173 1.0739366 0.9066043 1.3990207 1.2652262 0.8985093 0.9804217 #>   [50] 1.7487051 0.9379966 0.9481170 1.0352233 0.8151749 0.8027304 1.3527189 #>   [57] 0.9422655 1.1164607 1.2615272 1.2671306 1.3759759 1.0191671 0.8354318 #>   [64] 0.9174947 1.0557189 1.4388273 0.8534558 1.3311217 1.2395776 0.9967212 #>   [71] 1.0494749 1.2752345 0.9821393 1.1698682 0.9558158 1.7409846 0.8735523 #>   [78] 1.3960680 1.5717152 1.0734546 1.6630108 0.9732870 1.2405639 0.9968324 #>   [85] 0.9921217 1.3047176 1.2662755 0.9701085 0.9351444 1.1487724 1.6631019 #>   [92] 1.1722495 1.3307371 0.9086872 1.8099243 1.1018621 1.1162258 1.2399825 #>   [99] 0.8332701 0.7763285 1.0510282 1.3708051 0.9888339 1.1297338 0.8536308 #>  [106] 0.9815936 1.3074697 0.9539851 1.3265123 0.9382346 0.8688166 1.1010292 #>  [113] 1.0316060 0.8037925 0.7853484 1.6812585 0.8951223 1.2102873 0.9422796 #>  [120] 0.8836513 0.9040820 1.0405888 1.2409796 1.2153818 0.9933623 0.9773789 #>  [127] 0.9902265 1.0207041 0.9847097 1.1376395 1.1286470 0.9680966 1.2026271 #>  [134] 0.8776618 1.3311766 1.0732364 0.9870903 0.9370892 0.9545232 1.2927764 #>  [141] 1.2453655 1.1644919 1.1775174 1.0277052 0.8435302 1.2205381 1.0423525 #>  [148] 1.6024530 1.2794804 0.8905662 1.2781663 1.1216695 0.8590900 0.8640387 #>  [155] 0.8960094 0.9713478 1.4063023 1.1041156 1.1724739 0.8735625 0.8931753 #>  [162] 0.8957292 1.2798245 1.1135945 1.1949603 1.1760840 0.9353620 1.0140238 #>  [169] 0.8996274 0.9619309 0.9018214 1.2148860 0.9042683 1.3939265 1.3074356 #>  [176] 1.0092804 1.8949098 0.8726715 1.1215232 1.0923779 0.7494237 1.4257250 #>  [183] 0.9138873 1.0888683 0.8967828 1.1332383 1.0581472 0.7257049 1.1233516 #>  [190] 1.3209956 1.0999469 0.9665669 0.8725458 1.4846639 1.5178553 1.1744678 #>  [197] 0.9885052 1.1440306 1.2284157 0.8590662 0.8242157 0.9397441 1.6826078 #>  [204] 0.8582503 0.8816693 1.0861882 0.8530352 1.0994943 1.3141346 0.9114826 #>  [211] 1.0640180 0.9418990 1.5487989 0.7731689 1.2442573 0.9615991 1.4582586 #>  [218] 1.0504650 1.2151251 0.8787166 1.4274119 0.8200865 1.5268886 1.1699392 #>  [225] 1.0561482 1.6072839 0.7774859 0.9270879 0.8976341 0.9132454 0.9169890 #>  [232] 1.0262413 0.9498235 0.8180341 1.6087556 0.9434212 1.8341729 0.7792429 #>  [239] 0.9005696 0.8884342 0.9149875 0.8335506 1.1976040 1.2305995 1.5810020 #>  [246] 1.8981255 1.4964304 0.8998301 0.9010200 1.4753082 1.0793711 0.9841232 #>  [253] 1.0221553 1.5772845 1.1148867 0.9225681 1.0515687 1.4617682 1.7120403 #>  [260] 0.8368791 0.9927182 0.9968329 1.0941714 0.9775788 0.8250527 1.0741616 #>  [267] 1.6024648 1.0750122 1.2677887 0.7482752 0.9033348 1.2272645 1.4155088 #>  [274] 1.0727089 1.2867506 1.4937502 0.9957039 0.9932799 0.8850093 0.8672366 #>  [281] 0.9751043 0.9578719 1.7343872 1.3270094 1.2387866 1.0358667 1.4805825 #>  [288] 0.9615613 1.7002316 0.8548244 1.1413717 1.2719355 0.9074728 0.8551519 #>  [295] 0.8273726 0.7825598 1.0734035 1.0156257 1.0232067 1.1251500 1.0288780 #>  [302] 1.0210980 1.0031692 0.9522339 1.6656612 0.8649798 1.0454898 0.7861941 #>  [309] 0.9723041 1.2243168 0.9890471 1.6053050 0.8148866 1.6276536 1.0815559 #>  [316] 0.8356213 1.1056487 0.9871332 0.8952560 1.0337108 1.6242352 1.1460372 #>  [323] 0.9328423 0.8098266 1.2878666 1.1230190 0.7271989 1.4985064 0.9177068 #>  [330] 0.8405686 0.8654930 1.0181972 1.1402871 1.1349020 1.9335540 1.1434051 #>  [337] 0.9104758 0.9921450 1.2393079 0.8525174 1.0412449 1.4577304 1.4992914 #>  [344] 1.0402212 1.1087659 1.6267432 1.0503318 1.7073751 1.9409672 1.0067762 #>  [351] 1.7997862 0.8163827 1.1950013 1.3316065 0.7810669 0.9993326 0.8703789 #>  [358] 0.9864452 1.2636929 0.9607100 0.9135613 0.8880031 1.0012003 1.3538913 #>  [365] 1.0840496 0.7708952 1.0057595 1.1838343 1.0443542 0.9415395 1.5339131 #>  [372] 1.0190943 0.9344871 1.3915259 0.7856593 1.1914803 0.8133196 1.1211724 #>  [379] 0.8374120 0.9907554 1.3317013 1.0404207 1.5066686 0.8838986 1.0882345 #>  [386] 0.8040459 1.1436462 1.1395433 0.9720423 1.0658366 1.0144507 1.0138182 #>  [393] 0.9524594 0.9282689 1.0183550 1.5666410 0.8849411 0.8618126 0.9572163 #>  [400] 0.7304401 0.9409757 1.0231230 0.9157426 0.8744313 1.1567075 0.9189132 #>  [407] 1.3449683 1.1801247 1.3552237 0.8764293 1.2042221 1.0105596 0.9198837 #>  [414] 1.2710168 1.5631632 1.0489894 1.3646990 0.9890831 1.3213457 0.9302927 #>  [421] 1.0887065 0.9643093 1.6969682 1.1912289 0.7721216 1.0918894 1.4611320 #>  [428] 1.0329367 1.0543370 1.3667792 0.9749394 0.6632884 0.9604572 0.9964883 #>  [435] 0.9667361 0.7756026 1.2024895 1.7514198 1.1069375 1.0133954 1.0602046 #>  [442] 1.2275655 0.9315797 1.1092316 0.7824310 0.7746130 0.9963018 0.9439471 #>  [449] 1.0938485 1.0263663 0.8007696 0.9681048 0.9643771 1.0923812 0.8820778 #>  [456] 0.9208798 0.7655324 0.9552175 0.9505469 1.3196035 1.2048004 1.0173224 #>  [463] 1.0546183 0.9884774 0.7918321 1.4478137 1.3487156 0.9815917 0.8790189 #>  [470] 0.9115550 1.4200406 1.1246982 1.5262796 1.2748923 0.9872353 1.0890931 #>  [477] 0.8937860 0.9804998 0.9284644 1.0113118 0.9543701 0.9602624 0.9666643 #>  [484] 1.0500020 0.8439746 0.9108924 1.0925567 1.4795015 2.1427690 1.2573182 #>  [491] 0.7358932 0.9971820 1.0187616 1.0592232 1.0578971 1.1019207 1.3660899 #>  [498] 1.0444301 0.8734019 0.9315682 1.1033493 0.9331572 1.9983701 0.9938724 #>  [505] 0.9850826 1.2546327 0.8972035 0.7106203 0.9918081 1.0690031 1.1539233 #>  [512] 0.9898952 0.8895125 1.0007828 0.8691118 1.0019154 1.1363196 1.1818984 #>  [519] 1.2540592 0.7255987 0.8358345 0.9053410 1.2366813 0.8095272 1.1266211 #>  [526] 0.9747747 0.7557550 1.5492638 1.1240904 1.9380907 0.9313396 1.1465215 #>  [533] 1.0439445 1.3701700 1.6044948 0.8687008 1.3683569 0.9415649 0.7837430 #>  [540] 0.8199689 1.2412027 1.2639162 1.1241057 1.0256931 1.3805902 1.4367536 #>  [547] 0.8204292 1.1154761 0.7955712 1.5862869 1.3288277 0.9346837 1.0299958 #>  [554] 1.2816278 0.7378740 1.3889970 0.7040218 1.1350743 0.8701815 0.9038282 #>  [561] 1.0261739 0.7782787 0.8124048 0.9844118 0.8369430 1.1227342 1.2052904 #>  [568] 1.0397133 0.8820470 1.1561267 1.0912651 0.8516836 0.9348832 1.2545004 #>  [575] 1.2158561 1.2792454 1.0335591 0.8408526 0.9466246 1.0182594 1.0124534 #>  [582] 0.8775316 0.7478508 1.3166439 1.3959354 1.0378100 1.1028428 1.5823882 #>  [589] 0.9328113 0.8383373 0.8707653 1.1813271 0.6279620 0.8461423 0.7775523 #>  [596] 0.9867494 0.8652759 1.8499937 1.0266085 0.8855366 0.9536974 0.9494954 #>  [603] 1.0894901 0.9265205 1.2227871 0.9512458 1.3332983 1.0382299 1.4050047 #>  [610] 0.9561603 1.4765155 0.8995523 0.9701140 1.0069862 0.7902632 0.7563352 #>  [617] 0.7167796 1.2923505 0.8208209 1.4859063 0.7680378 0.9885494 0.6789709 #>  [624] 1.2006659 0.9268232 1.2263901 0.8877314 1.1678819 0.9720013 1.3050595 #>  [631] 0.9272178 0.8266728 1.1593735 1.1093710 1.2109391 0.8558345 0.7846813 #>  [638] 0.9409121 0.8431000 0.9592220 1.1869166 0.8737873 1.2784068 1.0796151 #>  [645] 0.8982459 1.3838689 0.8927775 1.0333248 0.9568198 1.2067800 1.0927228 #>  [652] 0.9947414 0.9498416 1.0103997 1.3611343 0.8609959 0.9947773 1.0753748 #>  [659] 1.1711604 0.9778606 0.7586331 1.2708869 0.8402792 1.2605015 1.2500388 #>  [666] 1.2538967 0.8592620 0.8281610 0.9917388 1.7738724 1.3137885 0.9934063 #>  [673] 1.1282881 1.6458795 1.5696287 0.7944633 1.4411913 0.9886647 0.9537603 #>  [680] 0.8587141 1.1261851 1.3969454 0.9196257 1.5202210 0.8055882 1.1334642 #>  [687] 1.6225973 1.7075842 1.7130024 1.0204473 0.7759071 0.6781255 1.0796494 #>  [694] 1.2831346 1.3705542 0.8889987 1.4301106 1.3056506 1.0348393 1.1613877 #>  [701] 1.0824519 1.0334387 1.6405251 0.8663971 1.8208157 1.0807111 1.0070685 #>  [708] 0.9971662 1.5860807 1.0268587 0.9022911 1.0639592 1.6654311 0.9271714 #>  [715] 1.3855266 0.9213376 1.0833745 1.3720685 0.7371681 1.0662725 1.1277261 #>  [722] 0.8190291 1.0788086 1.1059765 0.9870842 0.8139795 1.0161398 0.8759279 #>  [729] 1.1249102 1.1000808 1.0870796 0.7130284 0.8000653 0.8861104 0.8692996 #>  [736] 1.2419059 1.0770611 0.7859969 1.3829018 1.0118660 1.4981071 0.9901608 #>  [743] 1.3372909 0.7489684 1.6145665 1.3377751 0.9090100 1.1218480 1.1157796 #>  [750] 1.0981133 1.9507109 1.0515882 1.2098694 0.7535790 0.8320796 1.1466670 #>  [757] 1.1121406 0.7262401 1.1785608 1.3482335 0.9037390 1.8012956 0.9995032 #>  [764] 1.4705433 1.4127364 1.2468023 0.8873511 1.5307152 0.8308931 0.8509488 #>  [771] 1.1513510 1.5908971 1.5379122 0.7635531 0.9985825 1.1604138 1.1509394 #>  [778] 1.0066277 0.8566230 0.9541246 1.1803709 0.9283894 1.1806114 1.0044677 #>  [785] 1.2725144 0.7037450 1.0207364 1.1003758 1.5835103 0.8679408 0.7597829 #>  [792] 0.8136334 0.9413881 1.3403199 0.8207995 1.9463408 1.2651930 1.7864327 #>  [799] 1.3677958 0.9606124 1.3280093 1.1139535 1.1127319 0.8263717 1.0865105 #>  [806] 1.2475664 1.7821828 0.8887877 0.8719556 0.8527047 1.1389044 1.7320117 #>  [813] 0.8687406 1.0410953 0.7355501 1.0942220 1.2363625 1.3087023 1.7703644 #>  [820] 0.7319181 1.1667448 1.8827222 1.0778908 1.0876697 1.1584804 0.9723051 #>  [827] 0.9918570 1.0133968 0.8827414 0.6665200 2.6616823 0.9067998 1.1463636 #>  [834] 0.8656790 0.8877860 1.4805485 0.7554482 0.8436982 1.1343651 1.0306650 #>  [841] 0.9916045 0.9205743 1.1799757 1.0512076 0.9919211 0.8862709 0.8909555 #>  [848] 0.9533033 1.3163954 1.9937506 1.3783128 0.9409656 1.0821747 0.7782542 #>  [855] 0.7523202 0.6995704 1.5569973 0.9121943 1.1083932 1.0537227 1.0880884 #>  [862] 1.1293657 1.3176967 1.4429827 1.2672824 1.0110661 0.9522433 1.2229058 #>  [869] 0.9607410 1.4968553 0.7559348 1.6094077 0.9675808 1.5390456 1.4435104 #>  [876] 0.8891595 0.9705913 0.8573119 1.1494718 1.5759246 1.4916139 0.8596242 #>  [883] 0.8768427 1.1481618 1.5391725 0.9514265 1.1251974 1.0808842 0.7668270 #>  [890] 1.0667954 1.3102966 0.9128602 1.2260474 0.9247906 0.9415644 0.9038651 #>  [897] 0.7713014 1.2381369 1.1288572 1.1388306 1.2143659 1.1092383 0.8017548 #>  [904] 0.8349486 0.8911418 0.8105501 0.6971305 0.9859833 1.3333286 1.6420710 #>  [911] 0.9736603 1.0338463 0.9770103 0.8038449 1.3339665 0.9573870 0.8270833 #>  [918] 0.9044218 1.9341942 1.1576456 0.8818938 1.2715806 1.2803329 0.7634176 #>  [925] 0.7717598 0.8830934 1.5701326 0.8383628 1.2271847 1.4134921 1.0370250 #>  [932] 1.8741245 1.4117429 1.0581990 1.1410967 1.7783604 1.0786799 0.9730743 #>  [939] 0.9388762 1.7622652 1.0782470 1.1418353 0.9428629 0.7973967 0.8740372 #>  [946] 0.9265308 1.2618455 1.2859024 0.8053085 1.1299548 1.4064542 1.1991576 #>  [953] 0.9067375 0.7723277 1.0808458 0.6750782 1.1231567 1.0032127 1.1257916 #>  [960] 0.8704199 0.8057717 0.9481090 1.1908192 0.7644058 1.1513424 0.9701628 #>  [967] 0.9722068 1.0317511 1.2996910 0.9764997 0.7676091 1.4998971 0.7075949 #>  [974] 1.7924900 1.1756893 0.9950857 1.0105404 1.3420961 1.2489372 0.7850475 #>  [981] 1.1223816 0.7400216 1.0295374 1.1328577 0.9014050 1.1963039 0.9970070 #>  [988] 0.8926217 0.9157464 0.8689278 0.7790007 1.3663041 1.1218510 1.1592543 #>  [995] 1.1410281 0.7285511 1.3215018 1.1900303 0.8813189 0.8664149 cat(weights$model_string) #> model{ #> #N = nobs #> for(i in 1:N){ #>  #> # visit 1; #> # marginal treatment assignment model, visit 1; #> a_1s[i] ~ dbern(pa_1s[i]) #> pa_1s[i] <- ilogit(bs10) #>  #> # conditional treatment assignment model, visit 1; #> a_1[i] ~ dbern(pa_1[i]) #> pa_1[i] <- ilogit(b10 + b11*w1[i] + b12*w2[i] + b13*L1_1[i] + b14*L2_1[i]) #>  #> # visit 2; #> # marginal treatment assignment model, visit 2; #> a_2s[i] ~ dbern(pa_2s[i]) #> pa_2s[i] <- ilogit(bs20 + bs21*a_1s[i]) #>  #> # conditional treatment assignment model, visit 2; #> a_2[i] ~ dbern(pa_2[i]) #> pa_2[i] <- ilogit(b20 + b21*w1[i] + b22*w2[i] + b23*L1_1[i] + b24*L2_1[i] + b25*L1_2[i] + b26*L2_2[i] + b27*a_1[i]) #>  #> # export quantity in full posterior specification; #> w[i] <- (pa_1s[i]*pa_2s[i])/(pa_1[i]*pa_2[i]) #> } #>  #> #prior; #> bs10~dnorm(0,.01) #> b10~dnorm(0,.01) #> b11~dnorm(0,.01) #> b12~dnorm(0,.01) #> b13~dnorm(0,.01) #> b14~dnorm(0,.01) #> bs20~dnorm(0,.01) #> bs21~dnorm(0,.01) #> b20~dnorm(0,.01) #> b21~dnorm(0,.01) #> b22~dnorm(0,.01) #> b23~dnorm(0,.01) #> b24~dnorm(0,.01) #> b25~dnorm(0,.01) #> b26~dnorm(0,.01) #> b27~dnorm(0,.01) #> }"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight_cen.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen","title":"Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen","text":"`bayesweight_cen()` function estimates Bayesian importance sampling weights treatment models censoring models across multiple time points via JAGS","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight_cen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen","text":"","code":"bayesweight_cen(   trtmodel.list,   cenmodel.list,   data,   n.chains = 2,   n.iter = 25000,   n.burnin = 15000,   n.thin = 5,   seed = NULL,   parallel = TRUE )"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight_cen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen","text":"trtmodel.list list formulas corresponding time point time-specific treatment variable left-hand side pre-treatment covariates balanced right-hand side. formulas must temporal order, must contain covariates balanced time point. Interactions functions covariates allowed. cenmodel.list list formulas censored data time point, censoring indicators left-hand side covariates right-hand side. formulas must temporal order, must contain covariates balanced time point. data data set form data frame containing variables `trtmodel.list` `cenmodel.list`. must wide data set exactly one row per unit. n.chains Integer specifying number MCMC chains run. Set 1 non-parallel computation. parallel computation, required use least 2 chains. default 2. n.iter Integer specifying total number iterations chain (including burn-). default 25000. n.burnin Integer specifying number burn-iterations chain. default 15000. n.thin Integer specifying thinning rate MCMC sampler. default 5. seed Starting seed JAGS model. default NULL. parallel Logical scalar indicating whether run MCMC chains parallel. default TRUE.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight_cen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen","text":"list calculated weights JAGS model: * `weights` vector posterior mean weights, computed taking average weights across MCMC iterations. * `model_string` character JAGS model based input `trtmodel.list`.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/bayesweight_cen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen","text":"","code":"simdat_cen <- read.csv(system.file(\"extdata\",                                    \"sim_causal.csv\",                                    package = \"bayesmsm\")) weights_cen <- bayesweight_cen(trtmodel.list = list(A1 ~ L11 + L21,                                                     A2 ~ L11 + L21 + L12 +                                                          L22 + A1,                                                     A3 ~ L11 + L21 + L12 +                                                          L22 + A1 + L13 +                                                          L23 + A2),                                cenmodel.list = list(C1 ~ L11 + L21,                                                     C2 ~ L11 + L21 + A1,                                                     C3 ~ L11 + L21 + A1 +                                                          L12 + L22 + A2),                                data = simdat_cen,                                n.chains = 1,                                n.iter = 20,                                n.burnin = 10,                                n.thin = 1,                                seed = 890123,                                parallel = FALSE) #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 4836 #>    Unobserved stochastic nodes: 44 #>    Total graph size: 16501 #>  #> Initializing model #>  #> Warning: Some parameters have not converged with Geweke index > 1.96. More iterations may be needed. weights_cen$weights #>   [1]         NA         NA  1.4456133  1.0715142  6.3767871  0.9070324 #>   [7]  3.3210244  1.8321974         NA  0.5592724  0.2442320         NA #>  [13]  1.4225262         NA 37.8490445         NA  0.4769442  3.0263779 #>  [19]         NA  1.5506225         NA         NA  3.7260737  0.7879442 #>  [25]  0.6917942         NA  0.4741509  0.4868215  1.3762581         NA #>  [31]  1.7644462  0.4441765         NA  0.4472510         NA  5.1561126 #>  [37]  1.2810546  5.7495824         NA         NA         NA  1.0768918 #>  [43]         NA         NA  1.8367064         NA  5.6389345         NA #>  [49]  1.4975100         NA         NA  0.4997192  1.1363787         NA #>  [55]  2.8320738  1.7342932  0.4459201  0.5279491  0.5270837         NA #>  [61]  2.0478475  1.9635426  1.2480141  1.0049444  2.0639244  0.4959758 #>  [67]  1.5214438         NA  1.7043326  1.7448061  1.1183049  4.4624114 #>  [73]  0.6512373  1.0563612  1.2400973  1.3442917  0.3411946  1.6669307 #>  [79]  0.9193874  3.3864862  3.5010020  1.0749686         NA  0.8050216 #>  [85]  1.2781515  0.5329488         NA  1.9485849  0.9821594  0.6236220 #>  [91]  1.8419728  1.0563245         NA  0.6967079  2.4293466  0.6809041 #>  [97]  0.9762709  1.0680183  1.9336844  1.0718710  0.6376153  0.6996744 #> [103]  6.2722220  0.7656690  1.5343489  1.2324013  0.8898772  0.8659817 #> [109]  0.9459425  2.7988221  0.5811587  1.4012873         NA         NA #> [115]         NA  0.9036810  0.7869178  1.0150495  0.9925048         NA #> [121]  1.3388787  2.1164757  0.6054858  0.4968597  1.6053360  2.7785617 #> [127]  1.4506135         NA  2.7189633         NA  1.4651409  1.3614218 #> [133]  0.7406890  1.2300459  0.4787525  0.7312590  0.9020800         NA #> [139]  2.0741404  0.4468571  0.5854721         NA  1.8021092         NA #> [145]         NA         NA         NA  0.7037651  1.2322136  0.5022056 #> [151]  3.7040171         NA         NA  2.0604004         NA  0.6819747 #> [157]  0.6494412  1.5645470  1.3689165  1.1875363  1.3182951  0.3329154 #> [163]  1.7523019  1.1968655  1.2928663  1.6249260         NA  0.5358260 #> [169]  1.7634216  2.0409005  0.9906185  2.0518486  1.2544008  2.0134260 #> [175]  1.0081397  3.1160102  6.1098047  0.4252421  1.0909677  0.8257719 #> [181]  1.0980287  3.9284680         NA         NA         NA         NA #> [187]  0.5765073         NA         NA         NA  2.3200655  1.0379919 #> [193]  2.1571248  1.1832373  1.0393904         NA         NA  1.1582286 #> [199]  1.0410025         NA         NA  0.5988185  0.3856283         NA #> [205]  1.3315718         NA  0.6538336  1.4771296         NA  1.6878495 #> [211]         NA  3.4668441  0.5897674  4.6215902  0.6943383         NA #> [217]  3.4372221  1.9664473         NA  0.8104503         NA  1.2634746 #> [223]  0.3525822         NA  0.2904560         NA  1.5087182  1.0780067 #> [229]  0.9258581  1.1137677         NA  2.7953670         NA         NA #> [235]  2.9118667  0.5668535  0.8308761  0.8993407         NA  0.6487051 #> [241]  1.4571363         NA  2.5559407  0.2356121         NA  0.3428758 #> [247]  0.6861395  1.3287800         NA  0.4308363         NA  0.6082375 #> [253]  0.8363835  1.8886447         NA  1.4499738         NA         NA #> [259]  4.0740874         NA  0.8362394  2.1127773  2.2395512  1.0215676 #> [265]  0.9952046         NA         NA  0.6610745  1.1425156         NA #> [271]         NA  4.1480810  4.0564595  0.8689779  0.9018808  0.9783292 #> [277]  2.0577342  1.5355985  1.3854943  1.0600955  1.0559984  0.9412578 #> [283]  1.7413813         NA  0.7103160  0.8068407         NA  3.4827274 #> [289]  0.6625502         NA  1.6204999  1.4945044  0.3961832  1.5388599 #> [295]  0.6248668         NA  0.5146343         NA  2.3326226         NA #> [301]  1.6243442  1.6706995  3.0788630  2.1727795         NA  1.6599689 #> [307]         NA         NA  0.5672330         NA         NA  1.0512478 #> [313]  3.5016230  3.9159424         NA  0.3570301  1.2768014         NA #> [319]  0.8274960  1.3580063         NA  1.2694614  1.0038738  0.4780249 #> [325]  1.5702158  1.2814873  1.5303948  0.6270647  1.2761410  1.2092664 #> [331]  1.0827696  1.0789058         NA  1.0627837         NA  0.7235668 #> [337]  1.1008483  0.3534820         NA  0.3149297  1.9165977  2.5913339 #> [343]  0.7730444  1.0780128  1.2814587  1.0350312  1.1674616  0.5640669 #> [349]  2.1148995  4.5271434         NA  0.4879293  1.9530330  1.0044210 #> [355]  1.9785729  1.0685356         NA         NA  0.5781106         NA #> [361]  1.2009846  0.3138492  0.4777289  0.7180741  1.9054755  0.5487007 #> [367]  1.1429087         NA  0.9893906  2.5057329  0.3399657  0.4294825 #> [373]  1.2590526  3.3555596  2.1176526         NA  1.0037328  1.4862654 #> [379]         NA         NA         NA  1.5053632         NA  3.0063567 #> [385]  0.6905174         NA  1.5927066  1.6559885  2.4319522  0.2851862 #> [391]  0.8360234         NA  0.9172651  1.3624844         NA  0.5351303 #> [397]  1.5137546  0.5017157  1.4953819  1.2393174         NA  2.7721061 #> [403]  0.9551280         NA  2.7561145  2.0318988  0.9277557  0.4825569 #> [409]  0.5973345  2.1850863  3.5942345  1.7187104  0.6732510  1.3931529 #> [415]         NA  1.1775946  0.5614513  1.3514378  3.6329015         NA #> [421]  1.6391181  0.6338095         NA  0.9956453  0.9630407         NA #> [427]  1.4170987         NA  2.0208076         NA  2.0550856  1.7279942 #> [433]         NA  0.5467121  0.7137778  1.2377496         NA         NA #> [439]  1.2810709  1.1962992         NA  1.7409836  1.7464953  1.9314869 #> [445]  0.7202878         NA  1.4186516  1.3744740  2.2063415  0.8127669 #> [451]  1.3975347  1.3293163  1.4700721         NA  2.0259989  0.4385801 #> [457]  2.3511732  1.9721742  0.7115987  1.2397149         NA  1.5004124 #> [463]  1.2777516  5.0681893  3.3907895  2.1549335  2.4538680  1.3728407 #> [469]         NA         NA  0.4996574         NA         NA  1.0470441 #> [475]  1.0915790  0.6321866         NA  0.4714820         NA  1.2945633 #> [481]  0.6393459  1.2854676  1.6224881  1.1690034  1.3333225         NA #> [487]         NA  1.8120207  1.9643350  0.7704345  0.3947983         NA #> [493]  4.2129698  0.3870741  1.1818599         NA         NA  1.8135385 #> [499]  3.1182565  1.6182261 cat(weights_cen$model_string) #> model{ #>  #> for (i in 1:N1) { #>  #> # conditional model; #> A1[i] ~ dbern(p1[i]) #> logit(p1[i]) <- b10 + b11*L11[i] + b12*L21[i] #> C1[i] ~ dbern(cp1[i]) #> logit(cp1[i]) <- s10 + s11*L11[i] + s12*L21[i] #>  #> # marginal model; #> A1s[i] ~ dbern(p1s[i]) #> logit(p1s[i]) <- bs10 #> C1s[i] ~ dbern(cp1s[i]) #> logit(cp1s[i]) <- ts10 #> } #>  #> for (i in 1:N2) { #>  #> # conditional model; #> A2[i] ~ dbern(p2[i]) #> logit(p2[i]) <- b20 + b21*L11[i] + b22*L21[i] + b23*L12[i] + b24*L22[i] + b25*A1[i] #> C2[i] ~ dbern(cp2[i]) #> logit(cp2[i]) <- s20 + s21*L11[i] + s22*L21[i] + s23*A1[i] #>  #> # marginal model; #> A2s[i] ~ dbern(p2s[i]) #> logit(p2s[i]) <- bs20 + bs21*A1s[i] #> C2s[i] ~ dbern(cp2s[i]) #> logit(cp2s[i]) <- ts20 + ts21*A1s[i] #> } #>  #> for (i in 1:N3) { #>  #> # conditional model; #> A3[i] ~ dbern(p3[i]) #> logit(p3[i]) <- b30 + b31*L11[i] + b32*L21[i] + b33*L12[i] + b34*L22[i] + b35*A1[i] + b36*L13[i] + b37*L23[i] + b38*A2[i] #> C3[i] ~ dbern(cp3[i]) #> logit(cp3[i]) <- s30 + s31*L11[i] + s32*L21[i] + s33*A1[i] + s34*L12[i] + s35*L22[i] + s36*A2[i] #>  #> # marginal model; #> A3s[i] ~ dbern(p3s[i]) #> logit(p3s[i]) <- bs30 + bs31*A1s[i] + bs32*A2s[i] #> C3s[i] ~ dbern(cp3s[i]) #> logit(cp3s[i]) <- ts30 + ts31*A1s[i] + ts32*A2s[i] #> } #>  #> # Priors #> b10 ~ dunif(-10, 10) #> b11 ~ dunif(-10, 10) #> b12 ~ dunif(-10, 10) #> s10 ~ dunif(-10, 10) #> s11 ~ dunif(-10, 10) #> s12 ~ dunif(-10, 10) #> bs10 ~ dunif(-10, 10) #> ts10 ~ dunif(-10, 10) #> b20 ~ dunif(-10, 10) #> b21 ~ dunif(-10, 10) #> b22 ~ dunif(-10, 10) #> b23 ~ dunif(-10, 10) #> b24 ~ dunif(-10, 10) #> b25 ~ dunif(-10, 10) #> s20 ~ dunif(-10, 10) #> s21 ~ dunif(-10, 10) #> s22 ~ dunif(-10, 10) #> s23 ~ dunif(-10, 10) #> bs20 ~ dunif(-10, 10) #> bs21 ~ dunif(-10, 10) #> ts20 ~ dunif(-10, 10) #> ts21 ~ dunif(-10, 10) #> b30 ~ dunif(-10, 10) #> b31 ~ dunif(-10, 10) #> b32 ~ dunif(-10, 10) #> b33 ~ dunif(-10, 10) #> b34 ~ dunif(-10, 10) #> b35 ~ dunif(-10, 10) #> b36 ~ dunif(-10, 10) #> b37 ~ dunif(-10, 10) #> b38 ~ dunif(-10, 10) #> s30 ~ dunif(-10, 10) #> s31 ~ dunif(-10, 10) #> s32 ~ dunif(-10, 10) #> s33 ~ dunif(-10, 10) #> s34 ~ dunif(-10, 10) #> s35 ~ dunif(-10, 10) #> s36 ~ dunif(-10, 10) #> bs30 ~ dunif(-10, 10) #> bs31 ~ dunif(-10, 10) #> bs32 ~ dunif(-10, 10) #> ts30 ~ dunif(-10, 10) #> ts31 ~ dunif(-10, 10) #> ts32 ~ dunif(-10, 10) #> }"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/calculate_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"The `calculate_effect()` function to calculate the causal effect of an intervention given the parameter estimates and intervention levels — calculate_effect","title":"The `calculate_effect()` function to calculate the causal effect of an intervention given the parameter estimates and intervention levels — calculate_effect","text":"`calculate_effect()` function calculate causal effect intervention given parameter estimates intervention levels","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/calculate_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The `calculate_effect()` function to calculate the causal effect of an intervention given the parameter estimates and intervention levels — calculate_effect","text":"","code":"calculate_effect(   intervention_levels,   variables,   param_estimates,   treatment_effect_type )"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/calculate_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The `calculate_effect()` function to calculate the causal effect of an intervention given the parameter estimates and intervention levels — calculate_effect","text":"intervention_levels numeric vector indicating levels intervention predictor variable. variables list names response variable predictor variables extracted model. param_estimates vector parameter estimates model. treatment_effect_type Character string specifying type treatment effect estimate. Options \"sq\" sequential treatment effects, estimates effects specific treatment sequences across visits, \"cum\" cumulative treatment effects, assumes single cumulative treatment variable representing total exposure. default \"sq\".","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/calculate_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The `calculate_effect()` function to calculate the causal effect of an intervention given the parameter estimates and intervention levels — calculate_effect","text":"numeric value representing calculated effect specified intervention.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_APO.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Average Potential Outcomes (APO) — plot_APO","title":"Plot Average Potential Outcomes (APO) — plot_APO","text":"`plot_APO()` function plots density APO specified effect type bayesmsms output.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_APO.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Average Potential Outcomes (APO) — plot_APO","text":"","code":"plot_APO(input, effect_type, ...)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_APO.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Average Potential Outcomes (APO) — plot_APO","text":"input data frame model object containing 'bootdata', include 'effect_comparator' 'effect_reference' columns. effect_type character string specifying effect plot: 'effect_comparator' 'effect_reference'. ... Additional arguments passed plotting function.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_APO.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Average Potential Outcomes (APO) — plot_APO","text":"ggplot object representing density plot showing distribution specified average potential outcome (reference comparison).","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_APO.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Average Potential Outcomes (APO) — plot_APO","text":"","code":"testdata <- read.csv(system.file(\"extdata\",                                  \"continuous_outcome_data.csv\",                                  package = \"bayesmsm\")) model <- bayesmsm(ymodel = y ~ a_1+a_2,                            nvisit = 2,                            reference = c(rep(0,2)),                            comparator = c(rep(1,2)),                            treatment_effect_type = \"sq\",                            family = \"gaussian\",                            data = testdata,                            wmean = rep(1, 1000),                            nboot = 10,                            optim_method = \"BFGS\",                            parallel = FALSE) plot_APO(model$bootdata, effect_type = \"effect_comparator\")  plot_APO(model, effect_type = \"effect_reference\")"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_ATE.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Average Treatment Effect Density from bayesmsm output — plot_ATE","title":"Plot Average Treatment Effect Density from bayesmsm output — plot_ATE","text":"`plot_ATE()` function plots density ATE bayesmsms output.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_ATE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Average Treatment Effect Density from bayesmsm output — plot_ATE","text":"","code":"plot_ATE(   input,   ATE = \"RD\",   col_density = \"blue\",   fill_density = \"lightblue\",   main = \"Posterior Predictive Distribution of Average Treatment Effect\",   xlab = \"ATE\",   ylab = \"Posterior Predictive Distribution\",   xlim = NULL,   ylim = NULL,   ... )"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_ATE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Average Treatment Effect Density from bayesmsm output — plot_ATE","text":"input model object, data frame vector containing bootstrap estimates ATE. ATE define causal estimand interest RD, , RR. col_density Color density plot (default \"blue\"). fill_density Fill color density plot (default \"lightblue\"). main Title plot (default \"Density ATE Estimates\"). xlab X-axis label (default \"ATE\"). ylab Y-axis label (default \"Density\"). xlim Limits x-axis (default NULL). ylim Limits y-axis (default NULL). ... Additional graphical parameters passed plot function.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_ATE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Average Treatment Effect Density from bayesmsm output — plot_ATE","text":"ggplot object representing density plot posterior predictive distribution Average Treatment Effect (ATE).","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_ATE.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Average Treatment Effect Density from bayesmsm output — plot_ATE","text":"","code":"testdata <- read.csv(system.file(\"extdata\",                                  \"continuous_outcome_data.csv\",                                  package = \"bayesmsm\")) model <- bayesmsm(ymodel = y ~ a_1+a_2,                            nvisit = 2,                            reference = c(rep(0,2)),                            comparator = c(rep(1,2)),                            treatment_effect_type = \"sq\",                            family = \"gaussian\",                            data = testdata,                            wmean = rep(1, 1000),                            nboot = 10,                            optim_method = \"BFGS\",                            parallel = FALSE) plot_ATE(model)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_est_box.html","id":null,"dir":"Reference","previous_headings":"","what":"Error bar plots for causal treatment effects — plot_est_box","title":"Error bar plots for causal treatment effects — plot_est_box","text":"`plot_est_box()` function plots point estimates 95","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_est_box.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Error bar plots for causal treatment effects — plot_est_box","text":"","code":"plot_est_box(input, ...)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_est_box.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Error bar plots for causal treatment effects — plot_est_box","text":"input data frame model object containing 'bootdata', include 'effect_comparator', 'effect_reference', 'RD' columns. ... Additional arguments passed plotting function.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_est_box.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Error bar plots for causal treatment effects — plot_est_box","text":"ggplot object presenting error bar plot mean effects 95% confidence intervals comparator level, reference level, ATE.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/plot_est_box.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Error bar plots for causal treatment effects — plot_est_box","text":"","code":"testdata <- read.csv(system.file(\"extdata\",                                  \"continuous_outcome_data.csv\",                                  package = \"bayesmsm\")) model <- bayesmsm(ymodel = y ~ a_1+a_2,                            nvisit = 2,                            reference = c(rep(0,2)),                            comparator = c(rep(1,2)),                            treatment_effect_type = \"sq\",                            family = \"gaussian\",                            data = testdata,                            wmean = rep(1, 1000),                            nboot = 10,                            optim_method = \"BFGS\",                            parallel = FALSE) plot_est_box(model)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/summary_bayesmsm.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary function to generate result table from bayesmsm — summary_bayesmsm","title":"Summary function to generate result table from bayesmsm — summary_bayesmsm","text":"`summary_bayesmsm()` function generates ready use result table contents estimated APO ATE 95","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/summary_bayesmsm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary function to generate result table from bayesmsm — summary_bayesmsm","text":"","code":"summary_bayesmsm(model)"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/summary_bayesmsm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary function to generate result table from bayesmsm — summary_bayesmsm","text":"model model object bayesmsm","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/summary_bayesmsm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary function to generate result table from bayesmsm — summary_bayesmsm","text":"summary table results bayesmsm.","code":""},{"path":"https://kuan-liu-lab.github.io/bayesmsm/reference/summary_bayesmsm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary function to generate result table from bayesmsm — summary_bayesmsm","text":"","code":"# Continuous outcome testdata <- read.csv(system.file(\"extdata\", \"continuous_outcome_data.csv\", package = \"bayesmsm\")) model <- bayesmsm(ymodel = y ~ a_1+a_2,                            nvisit = 2,                            reference = c(rep(0,2)),                            comparator = c(rep(1,2)),                            treatment_effect_type = \"sq\",                            family = \"gaussian\",                            data = testdata,                            wmean = rep(1, 1000),                            nboot = 10,                            optim_method = \"BFGS\",                            seed = 890123,                            parallel = TRUE,                            ncore = 2) summary_bayesmsm(model) #>                 mean         sd       2.5%     97.5% #> Reference   2.330411 0.04747300  2.2593125  2.392486 #> Comparator -0.830137 0.06082704 -0.9031479 -0.733651 #> RD         -3.160548 0.09367865 -3.2684873 -2.997058"},{"path":"https://kuan-liu-lab.github.io/bayesmsm/news/index.html","id":"bayesmsm-100","dir":"Changelog","previous_headings":"","what":"bayesmsm 1.0.0","title":"bayesmsm 1.0.0","text":"Initial CRAN submission.","code":""}]
