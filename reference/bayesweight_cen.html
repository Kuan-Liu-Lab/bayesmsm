<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen • bayesmsm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen"><meta name="description" content="This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data."><meta property="og:description" content="This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bayesmsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bayesmsm-censoring.html">`bayesmsm` for longitudinal data with informative right-censoring</a></li>
    <li><a class="dropdown-item" href="../articles/bayesmsm-nocensoring.html">`bayesmsm` for longitudinal data without right-censoring</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Kuan-Liu-Lab/bayesmsm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Treatment Effect Weight Estimation for Censored Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/Kuan-Liu-Lab/bayesmsm/blob/main/R/bayesweight_cen.R" class="external-link"><code>R/bayesweight_cen.R</code></a></small>
      <div class="d-none name"><code>bayesweight_cen.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bayesweight_cen</span><span class="op">(</span></span>
<span>  <span class="va">trtmodel.list</span>,</span>
<span>  <span class="va">cenmodel.list</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  n.chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n.iter <span class="op">=</span> <span class="fl">25000</span>,</span>
<span>  n.burnin <span class="op">=</span> <span class="fl">15000</span>,</span>
<span>  n.thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-trtmodel-list">trtmodel.list<a class="anchor" aria-label="anchor" href="#arg-trtmodel-list"></a></dt>
<dd><p>A list of formulas corresponding to each time point with the time-specific treatment variable on the left-hand side and pre-treatment covariates to be balanced on the right-hand side. The formulas must be in temporal order, and must contain all covariates to be balanced at that time point. Interactions and functions of covariates are allowed.</p></dd>


<dt id="arg-cenmodel-list">cenmodel.list<a class="anchor" aria-label="anchor" href="#arg-cenmodel-list"></a></dt>
<dd><p>A list of formulas for the censored data at each time point, with censoring indicators on the left-hand side and covariates on the right-hand side. The formulas must be in temporal order, and must contain all covariates to be balanced at that time point.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data set in the form of a data frame containing the variables in `trtmodel.list` and `cenmodel.list`. This must be a wide data set with exactly one row per unit.</p></dd>


<dt id="arg-n-chains">n.chains<a class="anchor" aria-label="anchor" href="#arg-n-chains"></a></dt>
<dd><p>Integer specifying the number of MCMC chains to run. Set to 1 for non-parallel computation. For parallel computation, it is required to use at least 2 chains. The default is 2.</p></dd>


<dt id="arg-n-iter">n.iter<a class="anchor" aria-label="anchor" href="#arg-n-iter"></a></dt>
<dd><p>Integer specifying the total number of iterations for each chain (including burn-in). The default is 25000.</p></dd>


<dt id="arg-n-burnin">n.burnin<a class="anchor" aria-label="anchor" href="#arg-n-burnin"></a></dt>
<dd><p>Integer specifying the number of burn-in iterations for each chain. The default is 15000.</p></dd>


<dt id="arg-n-thin">n.thin<a class="anchor" aria-label="anchor" href="#arg-n-thin"></a></dt>
<dd><p>Integer specifying the thinning rate for the MCMC sampler. The default is 5.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Starting seed for the JAGS model. The default is NULL.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical scalar indicating whether to run the MCMC chains in parallel. The default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of the calculated weights and the JAGS model:
* `weights` is a vector of posterior mean weights, computed by taking the average of the weights across all MCMC iterations.
* `model_string` is a character of the JAGS model based on the input of `trtmodel.list`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">simdat_cen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"sim_causal.csv"</span>,</span></span>
<span class="r-in"><span>                                   package <span class="op">=</span> <span class="st">"bayesmsm"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weights_cen</span> <span class="op">&lt;-</span> <span class="fu">bayesweight_cen</span><span class="op">(</span>trtmodel.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">A2</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">L12</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L22</span> <span class="op">+</span> <span class="va">A1</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">A3</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">L12</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L22</span> <span class="op">+</span> <span class="va">A1</span> <span class="op">+</span> <span class="va">L13</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L23</span> <span class="op">+</span> <span class="va">A2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               cenmodel.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">C1</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">C2</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">A1</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">C3</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">A1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L12</span> <span class="op">+</span> <span class="va">L22</span> <span class="op">+</span> <span class="va">A2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               data <span class="op">=</span> <span class="va">simdat_cen</span>,</span></span>
<span class="r-in"><span>                               n.chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                               n.iter <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                               n.burnin <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>                               n.thin <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                               seed <span class="op">=</span> <span class="fl">890123</span>,</span></span>
<span class="r-in"><span>                               parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compiling model graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Resolving undeclared variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Allocating nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Graph information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Observed stochastic nodes: 4836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unobserved stochastic nodes: 44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total graph size: 16501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some parameters have not converged with Geweke index &gt; 1.96. More iterations may be needed.</span>
<span class="r-in"><span><span class="va">weights_cen</span><span class="op">$</span><span class="va">weights</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]         NA         NA  1.2642557  0.5421839  5.1068112  4.6106131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7]  2.5628611  1.1624346         NA  0.8615265  0.6453359         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [13]  0.7702220         NA 41.9686432         NA  2.1124888  2.8310504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19]         NA  0.8599781         NA         NA 11.0528462  0.6037800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25]  0.4256688         NA  1.6986594  0.4565428  4.0857228         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31]  0.6649828  0.4458072         NA  0.3572363         NA  4.7989275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37]  2.7796383  5.3666891         NA         NA         NA  3.1877134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43]         NA         NA  2.4763515         NA  5.7293331         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49]  4.4730435         NA         NA  0.6670697  1.8182251         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55]  6.1133190  5.1002404  2.4058608  1.6076956  2.0991117         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61]  1.6207057  1.8203088  4.0767679  2.7909660  0.9954311  2.2350067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [67]  0.8012886         NA  5.3213842  2.3524277  0.6137062 14.4063376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73]  0.4814783  3.0585212  3.6917356  1.8514919  1.2693188  2.0618678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [79]  1.2461243 10.9085170 10.9433822  1.4853800         NA  0.7802038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85]  3.7954172  2.9981071         NA  4.3043149  5.0666072  0.7836558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91]  5.5972972  0.7154000         NA  0.7297750  2.2584313  2.0463820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97]  1.8435590  0.9200094  1.6965353  0.5025329  1.1593356  1.1835386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [103]  5.8004972  1.5258320  4.5279686  2.5967291  1.0488590  0.8370011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [109]  3.2983603  3.1964225  2.2954880  4.2662150         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [115]         NA  1.3024985  1.4539403  0.4789716  4.7365412         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [121]  9.2243106  6.8533719  0.8516919  2.1079709  2.1741208  1.6865729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127]  8.6348186         NA  2.4642895         NA  0.7949080  0.6612319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [133]  0.7632680  0.4906116  1.9558100  3.8315631  1.0480859         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [139]  4.0974392  1.8327631  1.6497830         NA  8.8175462         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [145]         NA         NA         NA  3.0783729  3.5140238  1.8216870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [151]  2.5514611         NA         NA  3.0596808         NA  0.5479098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [157]  0.6114283  1.4002235  1.1771243  6.1854007  7.6027620  1.2965336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [163]  4.6876578  3.3932709  3.6855641  2.3783546         NA  0.6948663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [169]  1.5658269  1.7966367  0.6553735  6.3626982  0.5978526  1.5615526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [175]  1.5751493  1.7097782 25.2752348  1.4814711  1.3781355  1.1520594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [181]  1.9871549  3.6455640         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [187]  0.7670094         NA         NA         NA  7.5108366  2.9045571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [193]  5.8053818  2.1969254  1.9318729         NA         NA  2.6854334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [199]  0.9927477         NA         NA  2.6585032  1.2317302         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [205]  7.1478271         NA  2.9214279  4.4036496         NA  2.4948547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [211]         NA 11.1668383  2.4768534  2.8077242  0.6316468         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [217] 10.5717261  1.8439924         NA  0.9024179         NA  0.6123551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [223]  0.9126017         NA  1.1493831         NA  7.0997746  0.4974687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [229]  1.8109279  1.0773890         NA  3.9436728         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [235]  9.2009156  2.2599553  1.1410514  0.9189370         NA  2.6868934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [241]  0.6890612         NA  8.0389762  0.6135201         NA  0.9669870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [247]  3.0931571  2.7847929         NA  0.4276466         NA  2.9572903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [253]  0.8167080  2.5929929         NA  0.7530578         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [259] 13.3556901         NA  1.4256164  4.7082256  1.5310912  1.0479520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [265]  1.5852587         NA         NA  0.8977643  0.9746008         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [271]         NA  3.8508909  3.8901540  1.1899726  2.2713094  1.9900367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [277]  5.1859714  4.5829754  8.1537514  0.4611933  0.5965306  2.6109000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [283]  1.5281177         NA  2.9949116  3.4104411         NA 10.6960381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [289]  3.2739967         NA  1.4204256  4.3792715  1.3842232  0.6353565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [295]  2.7143352         NA  0.4107999         NA  8.5216926         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [301]  1.0437557  4.7639776  2.2734899  5.4781574         NA  1.4494831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [307]         NA         NA  2.6064797         NA         NA  2.9247011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [313]  1.7279637  3.7861368         NA  1.1352616  0.8403243         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [319]  0.7090024  0.7228321         NA  1.0829929  0.8645996  1.4862268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [325]  1.4680649  3.7882913  1.6797210  1.6397124  1.0821975  0.6213965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [331]  0.4988684  0.9434763         NA  2.4011062         NA  0.6251752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [337]  0.5883513  1.0465093         NA  0.7902789  6.4139946  7.8854022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [343]  1.7026138  2.9833726  3.7689096  0.9666110  0.5736311  0.8611906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [349] 10.2891220  3.8340888         NA  1.7631570  1.2640729  2.8286075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [355]  1.3177636  0.5049690         NA         NA  0.8141416         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [361]  3.5503212  1.4486297  0.5244178  3.1316260  9.9784253  0.3168891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [367]  1.0685940         NA  2.7226870  8.1026539  1.6659846  1.7689128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [373]  1.4354677 10.6149158  1.0297974         NA  1.9091373  1.3922008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [379]         NA         NA         NA  0.5082350         NA  1.9850473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [385]  0.7465171         NA  4.7496394  1.5066564  7.6490448  1.0315575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [391]  0.7329128         NA  0.4396534  0.8033730         NA  0.7247949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [397]  1.3065018  2.2666238  1.3333333  3.0364208         NA  4.0021068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [403]  1.0096923         NA  2.4445359  1.7927218  0.5483263  0.6158796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [409]  0.8165261  1.3123588  3.2731828  5.1866377  2.7314379  1.3067124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [415]         NA  3.3024311  0.5434301  1.1772067  3.5149072         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [421]  0.8110116  0.9197182         NA  0.8483333  0.4712121         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [427]  1.3315163         NA  1.7809490         NA  5.0221243  1.1214163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [433]         NA  1.8635812  0.9970177  0.5173897         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [439]  1.1142728  3.5302873         NA  1.2665887  1.1950861  1.6939471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [445]  0.5218719         NA  0.7313385  1.1894313  6.7359700  0.6052058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [451]  6.0693534  1.1289624  1.2707285         NA  6.3298339  1.4326902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [457]  5.3628578  0.8424320  0.8937966  5.6160488         NA  4.4530376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [463]  3.6230589  4.5539411  2.7234565  6.2563164  7.6627906  0.6145252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [469]         NA         NA  0.7000282         NA         NA  0.3420752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [475]  0.5480696  2.8847894         NA  1.8835697         NA  0.8873318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [481]  2.6136825  0.7934250  5.1132869  1.4806361  2.7292906         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [487]         NA  1.1424842  1.8419137  1.7765518  1.2875978         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [493] 16.0166576  1.3178576  1.0443955         NA         NA  1.5957681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [499] 12.9504441  0.8241830</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">weights_cen</span><span class="op">$</span><span class="va">model_string</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model{</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N1) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1[i] ~ dbern(p1[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p1[i]) &lt;- b10 + b11*L11[i] + b12*L21[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C1[i] ~ dbern(cp1[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp1[i]) &lt;- s10 + s11*L11[i] + s12*L21[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1s[i] ~ dbern(p1s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p1s[i]) &lt;- bs10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C1s[i] ~ dbern(cp1s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp1s[i]) &lt;- ts10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N2) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2[i] ~ dbern(p2[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p2[i]) &lt;- b20 + b21*L11[i] + b22*L21[i] + b23*L12[i] + b24*L22[i] + b25*A1[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C2[i] ~ dbern(cp2[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp2[i]) &lt;- s20 + s21*L11[i] + s22*L21[i] + s23*A1[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2s[i] ~ dbern(p2s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p2s[i]) &lt;- bs20 + bs21*A1s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C2s[i] ~ dbern(cp2s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp2s[i]) &lt;- ts20 + ts21*A1s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N3) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A3[i] ~ dbern(p3[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p3[i]) &lt;- b30 + b31*L11[i] + b32*L21[i] + b33*L12[i] + b34*L22[i] + b35*A1[i] + b36*L13[i] + b37*L23[i] + b38*A2[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C3[i] ~ dbern(cp3[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp3[i]) &lt;- s30 + s31*L11[i] + s32*L21[i] + s33*A1[i] + s34*L12[i] + s35*L22[i] + s36*A2[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A3s[i] ~ dbern(p3s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p3s[i]) &lt;- bs30 + bs31*A1s[i] + bs32*A2s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C3s[i] ~ dbern(cp3s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp3s[i]) &lt;- ts30 + ts31*A1s[i] + ts32*A2s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Priors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b11 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b12 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s11 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s12 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b22 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b23 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b24 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b25 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s22 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s23 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b33 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b34 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b35 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b36 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b37 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b38 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s33 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s34 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s35 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s36 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kuan Liu, Xiao Yan, Martin Urner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

