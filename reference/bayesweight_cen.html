<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen • bayesmsm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen"><meta name="description" content="This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data."><meta property="og:description" content="This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bayesmsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bayesmsm-censoring.html">`bayesmsm` for longitudinal data with informative right-censoring</a></li>
    <li><a class="dropdown-item" href="../articles/bayesmsm-nocensoring.html">`bayesmsm` for longitudinal data without right-censoring</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Kuan-Liu-Lab/bayesmsm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Treatment Effect Weight Estimation for Censored Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/Kuan-Liu-Lab/bayesmsm/blob/main/R/bayesweight_cen.R" class="external-link"><code>R/bayesweight_cen.R</code></a></small>
      <div class="d-none name"><code>bayesweight_cen.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bayesweight_cen</span><span class="op">(</span></span>
<span>  <span class="va">trtmodel.list</span>,</span>
<span>  <span class="va">cenmodel.list</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  n.chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n.iter <span class="op">=</span> <span class="fl">25000</span>,</span>
<span>  n.burnin <span class="op">=</span> <span class="fl">15000</span>,</span>
<span>  n.thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-trtmodel-list">trtmodel.list<a class="anchor" aria-label="anchor" href="#arg-trtmodel-list"></a></dt>
<dd><p>A list of formulas corresponding to each time point with the time-specific treatment variable on the left-hand side and pre-treatment covariates to be balanced on the right-hand side. The formulas must be in temporal order, and must contain all covariates to be balanced at that time point. Interactions and functions of covariates are allowed.</p></dd>


<dt id="arg-cenmodel-list">cenmodel.list<a class="anchor" aria-label="anchor" href="#arg-cenmodel-list"></a></dt>
<dd><p>A list of formulas for the censored data at each time point, with censoring indicators on the left-hand side and covariates on the right-hand side. The formulas must be in temporal order, and must contain all covariates to be balanced at that time point.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data set in the form of a data frame containing the variables in `trtmodel.list` and `cenmodel.list`. This must be a wide data set with exactly one row per unit.</p></dd>


<dt id="arg-n-chains">n.chains<a class="anchor" aria-label="anchor" href="#arg-n-chains"></a></dt>
<dd><p>Integer specifying the number of MCMC chains to run. Set to 1 for non-parallel computation. For parallel computation, it is required to use at least 2 chains. The default is 2.</p></dd>


<dt id="arg-n-iter">n.iter<a class="anchor" aria-label="anchor" href="#arg-n-iter"></a></dt>
<dd><p>Integer specifying the total number of iterations for each chain (including burn-in). The default is 25000.</p></dd>


<dt id="arg-n-burnin">n.burnin<a class="anchor" aria-label="anchor" href="#arg-n-burnin"></a></dt>
<dd><p>Integer specifying the number of burn-in iterations for each chain. The default is 15000.</p></dd>


<dt id="arg-n-thin">n.thin<a class="anchor" aria-label="anchor" href="#arg-n-thin"></a></dt>
<dd><p>Integer specifying the thinning rate for the MCMC sampler. The default is 5.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Starting seed for the JAGS model. The default is NULL.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical scalar indicating whether to run the MCMC chains in parallel. The default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of the calculated weights and the JAGS model:
* `weights` is a vector of posterior mean weights, computed by taking the average of the weights across all MCMC iterations.
* `model_string` is a character of the JAGS model based on the input of `trtmodel.list`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">simdat_cen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"sim_causal.csv"</span>,</span></span>
<span class="r-in"><span>                                   package <span class="op">=</span> <span class="st">"bayesmsm"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weights_cen</span> <span class="op">&lt;-</span> <span class="fu">bayesweight_cen</span><span class="op">(</span>trtmodel.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">A2</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">L12</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L22</span> <span class="op">+</span> <span class="va">A1</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">A3</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">L12</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L22</span> <span class="op">+</span> <span class="va">A1</span> <span class="op">+</span> <span class="va">L13</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L23</span> <span class="op">+</span> <span class="va">A2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               cenmodel.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">C1</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">C2</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">A1</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">C3</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">A1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L12</span> <span class="op">+</span> <span class="va">L22</span> <span class="op">+</span> <span class="va">A2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               data <span class="op">=</span> <span class="va">simdat_cen</span>,</span></span>
<span class="r-in"><span>                               n.chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                               n.iter <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                               n.burnin <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                               n.thin <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                               seed <span class="op">=</span> <span class="fl">890123</span>,</span></span>
<span class="r-in"><span>                               parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compiling model graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Resolving undeclared variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Allocating nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Graph information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Observed stochastic nodes: 4836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unobserved stochastic nodes: 44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total graph size: 16501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some parameters have not converged with Geweke index &gt; 1.96. More iterations may be needed.</span>
<span class="r-in"><span><span class="va">weights_cen</span><span class="op">$</span><span class="va">weights</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]         NA         NA  1.4456133  1.0715142  6.3767871  0.9070324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7]  3.3210244  1.8321974         NA  0.5592724  0.2442320         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [13]  1.4225262         NA 37.8490445         NA  0.4769442  3.0263779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19]         NA  1.5506225         NA         NA  3.7260737  0.7879442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25]  0.6917942         NA  0.4741509  0.4868215  1.3762581         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31]  1.7644462  0.4441765         NA  0.4472510         NA  5.1561126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37]  1.2810546  5.7495824         NA         NA         NA  1.0768918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43]         NA         NA  1.8367064         NA  5.6389345         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49]  1.4975100         NA         NA  0.4997192  1.1363787         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55]  2.8320738  1.7342932  0.4459201  0.5279491  0.5270837         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61]  2.0478475  1.9635426  1.2480141  1.0049444  2.0639244  0.4959758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [67]  1.5214438         NA  1.7043326  1.7448061  1.1183049  4.4624114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73]  0.6512373  1.0563612  1.2400973  1.3442917  0.3411946  1.6669307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [79]  0.9193874  3.3864862  3.5010020  1.0749686         NA  0.8050216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85]  1.2781515  0.5329488         NA  1.9485849  0.9821594  0.6236220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91]  1.8419728  1.0563245         NA  0.6967079  2.4293466  0.6809041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97]  0.9762709  1.0680183  1.9336844  1.0718710  0.6376153  0.6996744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [103]  6.2722220  0.7656690  1.5343489  1.2324013  0.8898772  0.8659817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [109]  0.9459425  2.7988221  0.5811587  1.4012873         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [115]         NA  0.9036810  0.7869178  1.0150495  0.9925048         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [121]  1.3388787  2.1164757  0.6054858  0.4968597  1.6053360  2.7785617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127]  1.4506135         NA  2.7189633         NA  1.4651409  1.3614218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [133]  0.7406890  1.2300459  0.4787525  0.7312590  0.9020800         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [139]  2.0741404  0.4468571  0.5854721         NA  1.8021092         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [145]         NA         NA         NA  0.7037651  1.2322136  0.5022056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [151]  3.7040171         NA         NA  2.0604004         NA  0.6819747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [157]  0.6494412  1.5645470  1.3689165  1.1875363  1.3182951  0.3329154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [163]  1.7523019  1.1968655  1.2928663  1.6249260         NA  0.5358260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [169]  1.7634216  2.0409005  0.9906185  2.0518486  1.2544008  2.0134260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [175]  1.0081397  3.1160102  6.1098047  0.4252421  1.0909677  0.8257719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [181]  1.0980287  3.9284680         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [187]  0.5765073         NA         NA         NA  2.3200655  1.0379919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [193]  2.1571248  1.1832373  1.0393904         NA         NA  1.1582286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [199]  1.0410025         NA         NA  0.5988185  0.3856283         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [205]  1.3315718         NA  0.6538336  1.4771296         NA  1.6878495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [211]         NA  3.4668441  0.5897674  4.6215902  0.6943383         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [217]  3.4372221  1.9664473         NA  0.8104503         NA  1.2634746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [223]  0.3525822         NA  0.2904560         NA  1.5087182  1.0780067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [229]  0.9258581  1.1137677         NA  2.7953670         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [235]  2.9118667  0.5668535  0.8308761  0.8993407         NA  0.6487051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [241]  1.4571363         NA  2.5559407  0.2356121         NA  0.3428758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [247]  0.6861395  1.3287800         NA  0.4308363         NA  0.6082375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [253]  0.8363835  1.8886447         NA  1.4499738         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [259]  4.0740874         NA  0.8362394  2.1127773  2.2395512  1.0215676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [265]  0.9952046         NA         NA  0.6610745  1.1425156         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [271]         NA  4.1480810  4.0564595  0.8689779  0.9018808  0.9783292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [277]  2.0577342  1.5355985  1.3854943  1.0600955  1.0559984  0.9412578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [283]  1.7413813         NA  0.7103160  0.8068407         NA  3.4827274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [289]  0.6625502         NA  1.6204999  1.4945044  0.3961832  1.5388599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [295]  0.6248668         NA  0.5146343         NA  2.3326226         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [301]  1.6243442  1.6706995  3.0788630  2.1727795         NA  1.6599689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [307]         NA         NA  0.5672330         NA         NA  1.0512478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [313]  3.5016230  3.9159424         NA  0.3570301  1.2768014         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [319]  0.8274960  1.3580063         NA  1.2694614  1.0038738  0.4780249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [325]  1.5702158  1.2814873  1.5303948  0.6270647  1.2761410  1.2092664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [331]  1.0827696  1.0789058         NA  1.0627837         NA  0.7235668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [337]  1.1008483  0.3534820         NA  0.3149297  1.9165977  2.5913339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [343]  0.7730444  1.0780128  1.2814587  1.0350312  1.1674616  0.5640669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [349]  2.1148995  4.5271434         NA  0.4879293  1.9530330  1.0044210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [355]  1.9785729  1.0685356         NA         NA  0.5781106         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [361]  1.2009846  0.3138492  0.4777289  0.7180741  1.9054755  0.5487007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [367]  1.1429087         NA  0.9893906  2.5057329  0.3399657  0.4294825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [373]  1.2590526  3.3555596  2.1176526         NA  1.0037328  1.4862654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [379]         NA         NA         NA  1.5053632         NA  3.0063567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [385]  0.6905174         NA  1.5927066  1.6559885  2.4319522  0.2851862</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [391]  0.8360234         NA  0.9172651  1.3624844         NA  0.5351303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [397]  1.5137546  0.5017157  1.4953819  1.2393174         NA  2.7721061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [403]  0.9551280         NA  2.7561145  2.0318988  0.9277557  0.4825569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [409]  0.5973345  2.1850863  3.5942345  1.7187104  0.6732510  1.3931529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [415]         NA  1.1775946  0.5614513  1.3514378  3.6329015         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [421]  1.6391181  0.6338095         NA  0.9956453  0.9630407         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [427]  1.4170987         NA  2.0208076         NA  2.0550856  1.7279942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [433]         NA  0.5467121  0.7137778  1.2377496         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [439]  1.2810709  1.1962992         NA  1.7409836  1.7464953  1.9314869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [445]  0.7202878         NA  1.4186516  1.3744740  2.2063415  0.8127669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [451]  1.3975347  1.3293163  1.4700721         NA  2.0259989  0.4385801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [457]  2.3511732  1.9721742  0.7115987  1.2397149         NA  1.5004124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [463]  1.2777516  5.0681893  3.3907895  2.1549335  2.4538680  1.3728407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [469]         NA         NA  0.4996574         NA         NA  1.0470441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [475]  1.0915790  0.6321866         NA  0.4714820         NA  1.2945633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [481]  0.6393459  1.2854676  1.6224881  1.1690034  1.3333225         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [487]         NA  1.8120207  1.9643350  0.7704345  0.3947983         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [493]  4.2129698  0.3870741  1.1818599         NA         NA  1.8135385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [499]  3.1182565  1.6182261</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">weights_cen</span><span class="op">$</span><span class="va">model_string</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model{</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N1) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1[i] ~ dbern(p1[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p1[i]) &lt;- b10 + b11*L11[i] + b12*L21[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C1[i] ~ dbern(cp1[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp1[i]) &lt;- s10 + s11*L11[i] + s12*L21[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1s[i] ~ dbern(p1s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p1s[i]) &lt;- bs10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C1s[i] ~ dbern(cp1s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp1s[i]) &lt;- ts10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N2) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2[i] ~ dbern(p2[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p2[i]) &lt;- b20 + b21*L11[i] + b22*L21[i] + b23*L12[i] + b24*L22[i] + b25*A1[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C2[i] ~ dbern(cp2[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp2[i]) &lt;- s20 + s21*L11[i] + s22*L21[i] + s23*A1[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2s[i] ~ dbern(p2s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p2s[i]) &lt;- bs20 + bs21*A1s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C2s[i] ~ dbern(cp2s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp2s[i]) &lt;- ts20 + ts21*A1s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N3) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A3[i] ~ dbern(p3[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p3[i]) &lt;- b30 + b31*L11[i] + b32*L21[i] + b33*L12[i] + b34*L22[i] + b35*A1[i] + b36*L13[i] + b37*L23[i] + b38*A2[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C3[i] ~ dbern(cp3[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp3[i]) &lt;- s30 + s31*L11[i] + s32*L21[i] + s33*A1[i] + s34*L12[i] + s35*L22[i] + s36*A2[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A3s[i] ~ dbern(p3s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p3s[i]) &lt;- bs30 + bs31*A1s[i] + bs32*A2s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C3s[i] ~ dbern(cp3s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp3s[i]) &lt;- ts30 + ts31*A1s[i] + ts32*A2s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Priors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b11 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b12 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s11 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s12 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b22 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b23 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b24 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b25 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s22 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s23 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b33 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b34 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b35 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b36 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b37 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b38 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s33 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s34 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s35 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s36 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kuan Liu, Xiao Yan, Martin Urner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

