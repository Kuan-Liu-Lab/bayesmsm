<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen • bayesmsm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Treatment Effect Weight Estimation for Censored Data — bayesweight_cen"><meta name="description" content="This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data."><meta property="og:description" content="This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bayesmsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/bayesmsm-censoring.html">`bayesmsm` for longitudinal data with informative right-censoring</a></li>
    <li><a class="dropdown-item" href="../articles/bayesmsm-nocensoring.html">`bayesmsm` for longitudinal data without right-censoring</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Kuan-Liu-Lab/bayesmsm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Treatment Effect Weight Estimation for Censored Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/Kuan-Liu-Lab/bayesmsm/blob/main/R/bayesweight_cen.R" class="external-link"><code>R/bayesweight_cen.R</code></a></small>
      <div class="d-none name"><code>bayesweight_cen.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates Bayesian importance sampling weights for treatment models and censoring models across multiple time points.
The models can be run in parallel to estimate the weights for censored data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bayesweight_cen</span><span class="op">(</span></span>
<span>  <span class="va">trtmodel.list</span>,</span>
<span>  <span class="va">cenmodel.list</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  n.chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n.iter <span class="op">=</span> <span class="fl">25000</span>,</span>
<span>  n.burnin <span class="op">=</span> <span class="fl">15000</span>,</span>
<span>  n.thin <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-trtmodel-list">trtmodel.list<a class="anchor" aria-label="anchor" href="#arg-trtmodel-list"></a></dt>
<dd><p>A list of formulas corresponding to each time point with the time-specific treatment variable on the left-hand side and pre-treatment covariates to be balanced on the right-hand side. The formulas must be in temporal order, and must contain all covariates to be balanced at that time point. Interactions and functions of covariates are allowed.</p></dd>


<dt id="arg-cenmodel-list">cenmodel.list<a class="anchor" aria-label="anchor" href="#arg-cenmodel-list"></a></dt>
<dd><p>A list of formulas for the censored data at each time point, with censoring indicators on the left-hand side and covariates on the right-hand side. The formulas must be in temporal order, and must contain all covariates to be balanced at that time point.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data set in the form of a data frame containing the variables in `trtmodel.list` and `cenmodel.list`. This must be a wide data set with exactly one row per unit.</p></dd>


<dt id="arg-n-chains">n.chains<a class="anchor" aria-label="anchor" href="#arg-n-chains"></a></dt>
<dd><p>Integer specifying the number of MCMC chains to run. Set to 1 for non-parallel computation. For parallel computation, it is required to use at least 2 chains. The default is 2.</p></dd>


<dt id="arg-n-iter">n.iter<a class="anchor" aria-label="anchor" href="#arg-n-iter"></a></dt>
<dd><p>Integer specifying the total number of iterations for each chain (including burn-in). The default is 25000.</p></dd>


<dt id="arg-n-burnin">n.burnin<a class="anchor" aria-label="anchor" href="#arg-n-burnin"></a></dt>
<dd><p>Integer specifying the number of burn-in iterations for each chain. The default is 15000.</p></dd>


<dt id="arg-n-thin">n.thin<a class="anchor" aria-label="anchor" href="#arg-n-thin"></a></dt>
<dd><p>Integer specifying the thinning rate for the MCMC sampler. The default is 5.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Starting seed for the JAGS model. The default is NULL.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical scalar indicating whether to run the MCMC chains in parallel. The default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of the calculated weights and the JAGS model:
* `weights` is a vector of posterior mean weights, computed by taking the average of the weights across all MCMC iterations.
* `model_string` is a character of the JAGS model based on the input of `trtmodel.list`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">simdat_cen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"sim_causal.csv"</span>,</span></span>
<span class="r-in"><span>                                   package <span class="op">=</span> <span class="st">"bayesmsm"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weights_cen</span> <span class="op">&lt;-</span> <span class="fu">bayesweight_cen</span><span class="op">(</span>trtmodel.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">A2</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">L12</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L22</span> <span class="op">+</span> <span class="va">A1</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">A3</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">L12</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L22</span> <span class="op">+</span> <span class="va">A1</span> <span class="op">+</span> <span class="va">L13</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L23</span> <span class="op">+</span> <span class="va">A2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               cenmodel.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">C1</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">C2</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">A1</span>,</span></span>
<span class="r-in"><span>                                                    <span class="va">C3</span> <span class="op">~</span> <span class="va">L11</span> <span class="op">+</span> <span class="va">L21</span> <span class="op">+</span> <span class="va">A1</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                                                         <span class="va">L12</span> <span class="op">+</span> <span class="va">L22</span> <span class="op">+</span> <span class="va">A2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               data <span class="op">=</span> <span class="va">simdat_cen</span>,</span></span>
<span class="r-in"><span>                               n.chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                               n.iter <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>                               n.burnin <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                               n.thin <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                               seed <span class="op">=</span> <span class="fl">890123</span>,</span></span>
<span class="r-in"><span>                               parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compiling model graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Resolving undeclared variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Allocating nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Graph information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Observed stochastic nodes: 4836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unobserved stochastic nodes: 44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total graph size: 16501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some parameters have not converged with Geweke index &gt; 1.96. More iterations may be needed.</span>
<span class="r-in"><span><span class="va">weights_cen</span><span class="op">$</span><span class="va">weights</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1]         NA         NA  1.3181537  0.6485255  4.1984446  4.2858047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [7]  2.4057620  1.1096888         NA  0.9239421  0.8402782         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [13]  0.8262908         NA 21.8807863         NA  2.2559182  3.0520633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [19]         NA  0.9110585         NA         NA  8.8497556  0.6613183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25]  0.5522206         NA  1.7377072  0.5366206  4.7858593         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31]  0.8305732  0.4478124         NA  0.4163883         NA  4.5067340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [37]  2.8071403  4.0139072         NA         NA         NA  3.7833081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [43]         NA         NA  2.3212080         NA  4.6130582         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49]  5.2636897         NA         NA  0.7579971  2.7346251         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [55]  6.3765585  5.1705528  2.1971006  2.0538602  1.9112207         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61]  1.4961053  1.7823079  4.9105289  3.2669707  1.2347478  1.8808774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [67]  0.9111320         NA  4.9034164  2.4281209  0.7911967 13.3051676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73]  0.5354100  3.7814541  4.5754552  1.9391805  1.6160621  1.6507833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [79]  1.3579748 11.0605413 11.2496701  2.0134919         NA  0.8679503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [85]  4.4257430  2.6819463         NA  4.3587090  3.1657073  0.9642465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91]  5.2180181  0.8183414         NA  0.6600481  2.2327731  2.6197462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97]  2.1153669  1.0602776  1.8076925  0.6557731  1.4692285  1.1231202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [103]  5.0492464  2.0519455  4.9522685  2.7935375  0.9832600  0.8377470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [109]  3.5968062  3.0923311  1.8434963  4.8913728         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [115]         NA  1.3296895  1.7241407  0.6715433  3.8755273         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [121]  4.1412531  7.1872209  0.9587671  1.8816357  2.2843816  1.8421776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [127]  8.0558313         NA  2.4658013         NA  0.8535703  0.8178871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [133]  0.8173996  0.6502359  1.4936320  2.3071643  0.8727078         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [139]  4.4212193  1.7896425  2.2034573         NA  8.4839566         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [145]         NA         NA         NA  2.6885576  4.3228203  1.5628181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [151]  2.4898165         NA         NA  2.8605127         NA  0.8077778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [157]  0.6141652  1.4507573  1.3700963  4.7979925  4.4074743  1.5114750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [163]  5.0985477  3.7344909  4.1124723  3.1625812         NA  0.7519441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [169]  1.5927588  1.7599288  0.6916083  6.7100125  0.7401560  1.5215967</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [175]  1.9871608  1.6413083 16.2795643  1.3206485  1.2812873  1.8887033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [181]  2.3788383  3.4381271         NA         NA         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [187]  0.7861836         NA         NA         NA  8.0610921  3.2196394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [193]  4.9362088  3.1297085  2.7201227         NA         NA  2.6547595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [199]  1.1972010         NA         NA  1.9016187  1.3763587         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [205]  5.7431532         NA  2.7970490  5.6544056         NA  2.2397108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [211]         NA 10.4308607  2.3437941  2.7407671  0.8863485         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [217]  9.9501328  1.8133566         NA  0.8374330         NA  0.7408837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [223]  1.1368031         NA  1.3662972         NA  6.6666586  0.6271355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [229]  2.0480327  1.1115484         NA  4.0566075         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [235]  7.9924678  2.5502084  1.2181483  0.7985679         NA  2.0410340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [241]  0.8393464         NA  7.0189784  0.7561783         NA  1.1766319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [247]  2.8183437  2.9884731         NA  0.5059034         NA  2.9670290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [253]  0.8844609  2.4119083         NA  0.8819635         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [259] 11.3394804         NA  1.7571948  4.8550272  1.3629464  1.0110215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [265]  1.9953890         NA         NA  0.8969599  1.1299970         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [271]         NA  3.5829065  3.5321507  1.2755076  2.5395497  2.6073788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [277]  4.9263451  5.6455220  5.2720145  0.6002035  0.6627290  3.0202757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [283]  1.5793558         NA  2.4917939  3.7384110         NA 12.5676346</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [289]  3.3249427         NA  1.4508147  4.6290895  1.7789868  0.8089185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [295]  2.0084167         NA  0.5247868         NA  7.3775327         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [301]  1.0080918  6.3983055  1.8614595  4.9171171         NA  1.5344659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [307]         NA         NA  2.3972883         NA         NA  3.2818032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [313]  1.7453256  3.4579307         NA  1.0935996  0.9354720         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [319]  0.8930711  0.8204181         NA  1.2309496  0.9912740  1.5108349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [325]  1.5822175  4.6665885  1.6093908  2.1227874  1.2721539  0.7234652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [331]  0.6376950  1.0582765         NA  3.0555811         NA  0.7964952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [337]  0.6921915  1.0112246         NA  0.8365573  6.6470461  8.5020017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [343]  2.1748780  3.5032713  4.5119748  1.1814941  0.6947016  1.0042193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [349]  8.6937670  2.8426572         NA  1.5480820  1.3672409  3.3675145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [355]  1.1868718  0.6299586         NA         NA  0.9015471         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [361]  4.4773897  1.4349205  0.5817465  3.5610906  8.4897917  0.3965976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [367]  1.2236736         NA  3.4381832  6.7269185  1.7589784  1.7189978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [373]  1.2883925 11.0814479  1.0939628         NA  2.2200863  1.6707923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [379]         NA         NA         NA  0.6993143         NA  1.7034153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [385]  1.1989015         NA  6.0349054  1.5312946  8.5835117  1.4042855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [391]  0.7249956         NA  0.5871502  0.8586319         NA  0.8228823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [397]  1.4790790  2.4312573  1.4139149  2.8310137         NA  4.0277707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [403]  0.9630813         NA  2.2940183  1.9494436  0.6949307  0.6841297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [409]  0.9053807  1.2735262  3.4251007  4.9185795  2.8324145  1.4420590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [415]         NA  3.7124241  0.6246150  1.2883962  3.5688647         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [421]  0.9338434  1.2767401         NA  1.0375994  0.5929075         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [427]  1.5311232         NA  1.7004277         NA  4.8470275  1.1154586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [433]         NA  1.6394186  1.1007082  0.6974090         NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [439]  1.2201631  4.0477722         NA  1.2658091  1.1117622  1.7594298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [445]  0.5902012         NA  0.8188042  1.3528233  7.0384224  0.6438076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [451]  4.9100404  1.3306198  1.4066671         NA  7.0061699  1.3449183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [457]  5.5754761  1.0825522  1.0713907  5.8950952         NA  5.5207962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [463]  4.2670232  3.9994025  2.0151120  6.5227921  6.7690953  0.7745359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [469]         NA         NA  0.7442837         NA         NA  0.5636045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [475]  0.6480853  2.5413645         NA  2.2138153         NA  1.0265385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [481]  2.6683794  0.8141443  5.3226586  1.1916202  2.8922595         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [487]         NA  1.2533536  1.9736422  2.1657345  1.1862123         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [493] 12.4666360  1.4691172  1.1339184         NA         NA  1.7317881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [499]  8.2914919  1.0191915</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">weights_cen</span><span class="op">$</span><span class="va">model_string</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model{</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N1) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1[i] ~ dbern(p1[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p1[i]) &lt;- b10 + b11*L11[i] + b12*L21[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C1[i] ~ dbern(cp1[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp1[i]) &lt;- s10 + s11*L11[i] + s12*L21[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1s[i] ~ dbern(p1s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p1s[i]) &lt;- bs10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C1s[i] ~ dbern(cp1s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp1s[i]) &lt;- ts10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N2) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2[i] ~ dbern(p2[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p2[i]) &lt;- b20 + b21*L11[i] + b22*L21[i] + b23*L12[i] + b24*L22[i] + b25*A1[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C2[i] ~ dbern(cp2[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp2[i]) &lt;- s20 + s21*L11[i] + s22*L21[i] + s23*A1[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2s[i] ~ dbern(p2s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p2s[i]) &lt;- bs20 + bs21*A1s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C2s[i] ~ dbern(cp2s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp2s[i]) &lt;- ts20 + ts21*A1s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for (i in 1:N3) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # conditional model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A3[i] ~ dbern(p3[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p3[i]) &lt;- b30 + b31*L11[i] + b32*L21[i] + b33*L12[i] + b34*L22[i] + b35*A1[i] + b36*L13[i] + b37*L23[i] + b38*A2[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C3[i] ~ dbern(cp3[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp3[i]) &lt;- s30 + s31*L11[i] + s32*L21[i] + s33*A1[i] + s34*L12[i] + s35*L22[i] + s36*A2[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # marginal model;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A3s[i] ~ dbern(p3s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(p3s[i]) &lt;- bs30 + bs31*A1s[i] + bs32*A2s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C3s[i] ~ dbern(cp3s[i])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit(cp3s[i]) &lt;- ts30 + ts31*A1s[i] + ts32*A2s[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Priors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b11 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b12 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s11 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s12 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts10 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b22 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b23 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b24 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b25 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s22 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s23 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts20 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts21 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b33 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b34 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b35 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b36 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b37 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b38 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s33 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s34 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s35 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s36 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bs32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts30 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts31 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ts32 ~ dunif(-10, 10)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kuan Liu, Xiao Yan, Martin Urner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

